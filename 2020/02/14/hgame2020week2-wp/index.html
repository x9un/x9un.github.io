<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        hgame2020week2_wp - 9un&#39;s Blog
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> null </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>路人</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archive">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse"><span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#babyPy"><span class="toc-text">babyPy</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Verfication-code"><span class="toc-text">Verfication_code</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cosmos的午餐"><span class="toc-text">Cosmos的午餐</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#所见即为假"><span class="toc-text">所见即为假</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#地球上最后的夜晚"><span class="toc-text">地球上最后的夜晚</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#玩玩条码"><span class="toc-text">玩玩条码</span></a></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> null </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        hgame2020week2_wp
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2020-02-14 12:52:14</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#vidar" title="vidar">vidar</a>
        <span>/</span>
        
        <a class="tag" href="/tags/#ctf" title="ctf">ctf</a>
        <span>/</span>
        
        <a class="tag" href="/tags/#wp" title="wp">wp</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <p>凉了啊凉了啊  </p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="babyPy"><a href="#babyPy" class="headerlink" title="babyPy"></a>babyPy</h2><p>下载文件是个字节码，手动翻译一下，大概是这个样子<br><a href="https://anhkgg.com/python-bytecode/" target="_blank" rel="noopener">参考网址</a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tmp1=flag[::<span class="number">-1</span>]</span><br><span class="line">tmp2=list(tmp1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(tmp2)):</span><br><span class="line">	tmp3=tmp2[i<span class="number">-1</span>]^tmp2[i]       </span><br><span class="line">	tmp2[i]=tmp3</span><br><span class="line"></span><br><span class="line">res=bytes(tmp2).hex</span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure></p>
<p>根据异或公式，可得m[i]= cipher[i] ^ cipher[i-1]<br>于是有如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cipher=bytes().fromhex(<span class="string">'7d037d045717722d62114e6a5b044f2c184c3f44214c2d4a22'</span>)</span><br><span class="line">_cipher=list(cipher)</span><br><span class="line">m=<span class="string">b'&#125;                                        '</span></span><br><span class="line">_m=list(m)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(_cipher)):</span><br><span class="line">	tmp=_cipher[i]^_cipher[i<span class="number">-1</span>]</span><br><span class="line">	_m[i]=tmp</span><br><span class="line">flag=bytes(_m[::<span class="number">-1</span>])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Verfication-code"><a href="#Verfication-code" class="headerlink" title="Verfication_code"></a>Verfication_code</h2><p>由源码得sha256(xxxx+已知字符串)=已知密文，爆破求xxxx，输入后再输入I like playing Hgame<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> os, sys, signal</span><br><span class="line"><span class="keyword">import</span> string, random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">myStr=<span class="string">'L0ZzlogdBWx1hlXC'</span></span><br><span class="line">dstDigest=<span class="string">'236abe814ce3691e1d5959bd36b79ca31e3d31b6daf941fa60d2fb7f9a01b61d'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.permutations(string.ascii_letters+string.digits,<span class="number">4</span>):</span><br><span class="line">	proof=<span class="string">''</span>.join(i)+myStr</span><br><span class="line">	digest=sha256(proof.encode()).hexdigest()</span><br><span class="line">	<span class="keyword">if</span>(digest==dstDigest):</span><br><span class="line">		print(i)</span><br></pre></td></tr></table></figure></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Cosmos的午餐"><a href="#Cosmos的午餐" class="headerlink" title="Cosmos的午餐"></a>Cosmos的午餐</h2><p>(感谢出题人的耐心解答)<br>一开始以为在流量包里找png或者jpeg之类的，但是相关的提取出来感觉不太对劲…（根据题目图片应该是二次元妹子…)<br>先把log导入解密，在http中找，发现一个比较不一样的包<br><img src="wp2_img/01.png" alt=""><br>点进去看看发现含有zip文件格式，导出来看下里边有张图片，提示用outguess，并且备注里给了key，然后解密下就好，解完了是个网址，下载下来一个压缩包，里边的图片二维码扫一下就行</p>
<h2 id="所见即为假"><a href="#所见即为假" class="headerlink" title="所见即为假"></a>所见即为假</h2><p>发现7z可以直接解压，注释中的F5 key提示了F5隐写，于是利用F5-steganography<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java Extract ./<span class="number">11</span><span class="selector-class">.jpg</span> -e res -<span class="selector-tag">p</span> NllD7CQon6dBsFLr</span><br></pre></td></tr></table></figure></p>
<p>得到hex文本，复制进winhex可得flag</p>
<h2 id="地球上最后的夜晚"><a href="#地球上最后的夜晚" class="headerlink" title="地球上最后的夜晚"></a>地球上最后的夜晚</h2><p>解压得no password.pdf，想到pdf隐写，用wbStego4.3open解码得到一个txt文件，里边写着zip的解压密码，解压得一个doc文件，试试转成xml，用7z对doc解压后进入word文件夹，发现secret.xml，打开就是flag</p>
<h2 id="玩玩条码"><a href="#玩玩条码" class="headerlink" title="玩玩条码"></a>玩玩条码</h2><p>下载得一个zip，里边注释:Decode JPNPostCode to get MSUStegoVideo password<br>俩文件对应注释里边内容，先看postcode，这是个日本的邮政编码，我是在生成条码网站上手动对比，一个个试的，不过也不复杂，有规律<br><a href="https://cn.online-qrcode-generator.com/japanpost-barcode-generator" target="_blank" rel="noopener">日本邮政条形码生成器</a><br><img src="wp2_img/00.png" alt=""><br>第二个，根据提示下了virtualdub2，再安MSU StegoVideo 插件，这个只能运行32位的，打开后根据网上教程，输入上一步骤所得的码进行解码，<a href="https://blog.csdn.net/wy_bk/article/details/85217583" target="_blank" rel="noopener">使用 MSU StegoVideo</a><br>打开txt文件可得zip密码，7z解压后得条形码，在线扫一下就好<br><a href="https://online-barcode-reader.inliteresearch.com/" target="_blank" rel="noopener">Free Online Barcode Reader</a>  </p>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        
        <li>
            <a target="_blank"  href="https://github.com/x9un">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




    <script type="text/javascript">
       (function() {
           if (typeof LivereTower === 'function') { return; }

           var j, d = document.getElementById('lv-container');

           d.setAttribute('data-id','city');
           d.setAttribute('data-uid' , 'MTAyMC80ODAwNy8yNDUwNA==');

           j = document.createElement('script');
           j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
           j.async = true;

           d.appendChild(j);
       })();
    </script>
    <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
    </div>

</html>
